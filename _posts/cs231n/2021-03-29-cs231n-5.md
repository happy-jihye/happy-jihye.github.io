---
date: 2021-03-29
title: "[CS231n] 5. Convolutional Neural Networks"

excerpt: "ì´ í¬ìŠ¤íŒ…ì€ CS231nì˜ 5ê°•ì„ ìš”ì•½í•œ ê¸€ì…ë‹ˆë‹¤ ğŸ˜Š"

categories: 
  - cs231n
tags: 
  - cs231n
  - vision
# ëª©ì°¨
toc: true  
toc_sticky: true 
---

**Reference**

- [CS231n ê°•ì˜ë…¸íŠ¸ Convolutional Neural Networks](http://cs231n.github.io/convolutional-networks/)
- Lecture 05 - [( Slide Link,](http://cs231n.stanford.edu/slides/2017/cs231n_2017_lecture5.pdf) [,Youtube Link )](https://www.youtube.com/watch?v=h7iBpEHGVNc&list=PLC1qU-LWwrF64f4QKQT-Vg5Wr4qEE1Zxk&index=6)
- [ğŸŒº Happy-Jihye / CS 231n ê°•ì˜ ë…¸íŠ¸](https://happy-jihye.github.io/cs231n/cs231n-0/)

---



ì´ í¬ìŠ¤íŒ…ì€ CS231nì˜ 5ê°•ì„ ìš”ì•½í•œ ê¸€ì…ë‹ˆë‹¤ ğŸ˜Š

  

![image-20210329024521547](https://github.com/happy-jihye/happy-jihye.github.io/blob/master/_posts/cs231n/images/lec5/image-20210329024521547png?raw=1)

  

ì´ë²ˆ ê°•ì˜ì—ì„œëŠ” **CNN(Convolutional Neural Networks)**ì— ëŒ€í•´ ë°°ì›ë‹ˆë‹¤.  

CNNì€ ëŒ€í‘œì ì¸ ì´ë¯¸ì§€ ì²˜ë¦¬ë¥¼ ìœ„í•œ ë„¤íŠ¸ì›Œí¬ë¼ì„œ ë§ì´ë“¤ ì•„ì‹¤ ê²ƒ ê°™ì•„ìš”. ë§Œì•½ ê´€ë ¨ ì˜ˆì œë¥¼ ë‹¤ë¤„ë³´ì‹œê³  ì‹¶ìœ¼ì‹  ë¶„ë“¤ì€ MINISTë‚˜ CIFAR-10 datasetì„ ì´ìš©í•œ CNNëª¨ë¸ì„ ê³µë¶€í•˜ì‹œë©´ ì¢‹ì„ ê²ƒ ê°™ìŠµë‹ˆë‹¤ :)



ê°•ì˜ì˜ ì´ˆë°˜ë¶€ì—ëŠ” CNNì˜ ì—­ì‚¬ë„ ê°„ë‹¨í•˜ê²Œë‚˜ë§ˆ ì„¤ëª…í•©ë‹ˆë‹¤. ì´ ê¸€ì—ì„œëŠ” ì´ì— ëŒ€í•´ëŠ” ìƒëµí•˜ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤ :)

   

# Convolutional Neural Networks

 

  

![image-20210329031310050](https://github.com/happy-jihye/happy-jihye.github.io/blob/master/_posts/cs231n/images/lec5/image-20210329031310050.png?raw=1)

 ì´ì „ ì‹œê°„ì—ëŠ” **Fully Connected Layer**ì— ëŒ€í•´ ë°°ì› ì—ˆìŠµë‹ˆë‹¤. FC LayerëŠ” ë³´í†µ vectorë¥¼ ê¸¸ê²Œ í´ëŠ” ì—­í• ì„ í•˜ë©°,ìœ„ì˜ ì˜ˆì œì—ì„œëŠ” 3072 ì°¨ì›ì˜ ê¸¸ê²Œ í¸ ì´ë¯¸ì§€ë¥¼ ê°€ì¤‘ì¹˜ ë²¡í„° Wì™€ ê³±í•´ì„œ 10ì°¨ì›ì˜ activation vectorë¥¼ ì–»ì—ˆìŠµë‹ˆë‹¤. 

  

## 1. Convolution Layer

![image-20210329031807337](https://github.com/happy-jihye/happy-jihye.github.io/blob/master/_posts/cs231n/images/lec5/image-20210329031807337.png?raw=1)

  

- FC layerê°€ ì…ë ¥ ì´ë¯¸ì§€ë¥¼ ê¸¸ê²Œ íˆë‹¤ë©´, Convolution layerëŠ” ê¸°ì¡´ì˜ ì´ë¯¸ì§€ êµ¬ì¡°ë¥¼ ê·¸ëŒ€ë¡œ ìœ ì§€í•˜ê²Œ ë©ë‹ˆë‹¤. ì¦‰, **spartial structure**ë¥¼ ìœ ì§€í•œë‹¤ê³  ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. 

- ê·¸ë¦¬ê³  í•˜ëŠ˜ìƒ‰ì˜ ì‘ì€ **Filter**ëŠ” ê°€ì¤‘ì¹˜ ë²¡í„°ì˜ ì—­í• ì„ í•˜ê²Œ ë©ë‹ˆë‹¤. ìš°ë¦¬ëŠ” ì´ í•„í„°ë¥¼ ê°€ì§€ê³  ì´ë¯¸ì§€ë¥¼ ìŠ¬ë¼ì´ë”©í•˜ë©´ì„œ ê³µê°„ì ìœ¼ë¡œ ë‚´ì ì„ í•˜ê²Œ ë©ë‹ˆë‹¤.

- ì—¬ê¸°ì„œ <u>í•˜ë‚˜ì˜ filterëŠ” ì´ë¯¸ì§€ì˜ ì•„ì£¼ ì‘ì€ ë¶€ë¶„ì´ë‘ë§Œ ì—°ì‚°ì„ í•˜ì§€ë§Œ, depthì— ëŒ€í•´ì„œëŠ” input volumeì˜ full depthì— ëŒ€í•´ ë‚´ì ì„ í•©ë‹ˆë‹¤.</u>



## 1) **Filter**



![image-20210329032425424](https://github.com/happy-jihye/happy-jihye.github.io/blob/master/_posts/cs231n/images/lec5/image-20210329032425424.png?raw=1)



| First filter(blue)                                           | Second filter(green)                                         |
| ------------------------------------------------------------ | ------------------------------------------------------------ |
| ![image-20210329032549372](https://github.com/happy-jihye/happy-jihye.github.io/blob/master/_posts/cs231n/images/lec5/image-20210329032549372.png?raw=1) | ![image-20210329032614332](https://github.com/happy-jihye/happy-jihye.github.io/blob/master/_posts/cs231n/images/lec5/image-20210329032614332.png?raw=1) |

![image-20210329033140402](https://github.com/happy-jihye/happy-jihye.github.io/blob/master/_posts/cs231n/images/lec5/image-20210329033140402.png?raw=1)



ë³´í†µ Covolutional Layerì—ì„œëŠ” ì—¬ëŸ¬ ê°œì˜ í•„í„°ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤. ì—¬ëŸ¬ê°œì˜ í•„í„°ë¥¼ ì‚¬ìš©í•¨ìœ¼ë¡œì¨ ìš°ë¦¬ëŠ” ê° í•„í„°ë§ˆë‹¤ ë‹¤ë¥¸ íŠ¹ì§•ì„ ì¶”ì¶œí•  ìˆ˜ ìˆê²Œ ë©ë‹ˆë‹¤.

ìœ„ì˜ ì˜ˆì œì—ì„œëŠ” ì´ 6ê°œì˜ filterë¥¼ ì‚¬ìš©í•´ì„œ 6ê°œì˜ activation mapì„ êµ¬í–ˆë„¤ìš” :)



> ì´ë•Œ, ê°ê°ì˜ filterì™€ ì´ë¯¸ì§€ì˜ spatialí•œ ë¶€ë¶„ì€ ë‚´ì ì„ í•œë‹¤ê³  ìƒê°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê·¸ë ‡ê¸° ë•Œë¬¸ì— activation mapì˜ depthëŠ” 1ì´ ë©ë‹ˆë‹¤.
>
>  (depthì™€ channelì€ ë‹¤ë¥¸ë°, ë³´í†µ channelì€ filterì˜ ê°œìˆ˜ë¥¼ ëœ»í•©ë‹ˆë‹¤. ì´ëŠ” í›„ë°˜ë¶€ì— ì„¤ëª…í•˜ê² ìŠµë‹ˆë‹¤ğŸ˜Š)

  

### 2) ConvNet

![image-20210329033501628](https://github.com/happy-jihye/happy-jihye.github.io/blob/master/_posts/cs231n/images/lec5/image-20210329033501628.png?raw=1)

Conv layerì™€ Reluì™€ ê°™ì€ ì—¬ëŸ¬ activation functionì„ ì‚¬ìš©í•˜ì—¬ CNNì„ êµ¬ì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. 

   

![image-20210329033703245](https://github.com/happy-jihye/happy-jihye.github.io/blob/master/_posts/cs231n/images/lec5/image-20210329033703245.png?raw=1)



ì•ì„œ í•˜ë‚˜ì˜ Conv layer ëŠ” ì—¬ëŸ¬ ê°œì˜ filterë¥¼ ê°€ì§€ë©° ì´ëŠ” ê°ê°ì˜ ì¶œë ¥ mapì„ ë§Œë“ ë‹¤ê³  í–ˆëŠ”ë°ìš”,

ì—¬ëŸ¬ê°œì˜ Conv layerë¥¼ ìŒ“ê²Œ ë˜ë©´ ê° filterë“¤ì€ ê³„ì¸µì ìœ¼ë¡œ í•™ìŠµì„ í•˜ê²Œ ë©ë‹ˆë‹¤.

- ìœ„ì˜ ì˜ˆì œì—ì„œ ì•ìª½ì˜ filterë“¤ì€ edgeì™€ ê°™ì€ `low-level feature`ë¥¼ í•™ìŠµí•˜ê²Œ ë˜ê³ ,
- ì¤‘ê°„ì˜ filterë“¤ì€  `mid-level feature`ì„ í•™ìŠµí•˜ê³ 
- í›„ë°˜ë¶€ì˜ filterëŠ”  `high-level feature`ì„ í•™ìŠµí•©ë‹ˆë‹¤.

ì¦‰, ê³„ì¸µì  êµ¬ì¡°ë¥¼ ì„¤ê³„í•˜ê³  ì—­ì „íŒŒë¥¼ í†µí•´ í•™ìŠµì‹œí‚¤ë‹¤ë³´ë©´ <u> filterëŠ” ë„¤íŠ¸ì›Œí¬ì˜ ì•ìª½ì—ì„œëŠ” ë‹¨ìˆœí•œ ê²ƒë“¤ì„ ì²˜ë¦¬í•˜ê³  ë’¤ë¡œ ê°ˆìˆ˜ë¡ ì ì  ë³µì¡í•œ ê²ƒë“¤ì„ ì²˜ë¦¬í•˜ë„ë¡ í•™ìŠµë©ë‹ˆë‹¤.</u>



**Example of Activation map**

  

![image-20210329130239419](https://github.com/happy-jihye/happy-jihye.github.io/blob/master/_posts/cs231n/images/lec5/image-20210329130239419.png?raw=1)



ë§¨ ìœ„ì˜ ì‚¬ì§„ì€ 32ê°œì˜ 5x5 filterë“¤ì„ ì‹œê°í™”í•œ ê²ƒì…ë‹ˆë‹¤. 

í•„í„°ë¥¼ ìŠ¬ë¼ì´ë”© ì‹œí‚¤ë©´ì„œ í•™ìŠµì„ í•˜ë©´ í•„í„°ì™€ ë¹„ìŠ·í•œ ê°’ë“¤ì€ ë” ì»¤ì§€ê²Œ ë˜ë©°, ê²°ê³¼ê°’ìœ¼ë¡œ activationì´ ë‚˜ì˜µë‹ˆë‹¤. ì´ **activation**ëŠ” ë‹¨ì–´ ê·¸ëŒ€ë¡œ ì–´ëŠ ìœ„ì¹˜ì—ì„œ ì´ í•„í„°ê°€ í¬ê²Œ ë°˜ì‘í•˜ëŠ”ì§€ë¥¼ ë³´ì—¬ì¤ë‹ˆë‹¤.

  

![image-20210329130655527](https://github.com/happy-jihye/happy-jihye.github.io/blob/master/_posts/cs231n/images/lec5/image-20210329130655527.png?raw=1)

  

ë‹¤ìŒì€ CNNì´ ì–´ë–»ê²Œ ìˆ˜í–‰ë˜ëŠ”ì§€ë¥¼ ë‚˜íƒ€ë‚¸ ê·¸ë¦¼ì…ë‹ˆë‹¤.

Conv Layerí›„ì—ëŠ” activation funcë¥¼ ê±°ì¹˜ê²Œ ë˜ê³ , ì´ë¡œëŠ” `Relu` functionì„ ê°€ì¥ ë§ì´ ì‚¬ìš©í•©ë‹ˆë‹¤. 

ì—¬ëŸ¬ ê°œì˜ Conv-Relu layerë“¤ì„ ê±°ì¹˜ë©´ **pooling layer**ë¥¼ ê±°ì¹˜ê²Œ ë˜ë©° poolingì€ activation mapsì˜ ì‚¬ì´ì¦ˆë¥¼ ì¤„ì´ëŠ” ì—­í• ì„ í•©ë‹ˆë‹¤. ë§ˆì§€ë§‰ì€ **FC-Layer**ë¡œ ìš°ë¦¬ê°€ [ì§€ë‚œ 4ê°•](https://happy-jihye.github.io/cs231n/cs231n-4/)ì—ì„œ ë°°ìš´ layerì…ë‹ˆë‹¤. ì´ ë ˆì´ì–´ëŠ” ëª¨ë“  Convì¶œë ¥ê³¼ ì—°ê²°ë˜ì–´ìˆìœ¼ë©° ìµœì¢…ìŠ¤ì½”ì–´ë¥¼ ê³„ì‚°í•˜ê¸° ìœ„í•´ ì‚¬ìš©í•©ë‹ˆë‹¤.  



---

### 3) Filter

ë‹¤ì‹œ ëŒì•„ì™€ì„œ filter ì…ë‹ˆë‹¤.



![image-20210329131056228](https://github.com/happy-jihye/happy-jihye.github.io/blob/master/_posts/cs231n/images/lec5/image-20210329131056228.png?raw=1)



![img](https://miro.medium.com/max/2332/1*8dx6nxpUh2JqvYWPadTwMQ.gif)

ë‹¤ìŒì€ filterê°€ ì–´ë–»ê²Œ ìŠ¬ë¼ì´ë”©ì„ í•˜ë©´ì„œ inputê°’ì„ ì²˜ë¦¬í•˜ëŠ”ì§€ë¥¼ ê·¸ë¦¼ìœ¼ë¡œ ë‚˜íƒ€ë‚¸ ì˜ˆì œì…ë‹ˆë‹¤.

![img](https://miro.medium.com/max/535/1*Zx-ZMLKab7VOCQTxdZ1OAw.gif)

  

ì˜ˆë¥¼ ë“¤ì–´ strideê°€ 1ì´ë¼ë©´ ë‹¤ìŒê³¼ ê°™ì´ ì›€ì§ì…ë‹ˆë‹¤.

ì¦‰, ìœ„ì˜ ì˜ˆì œì—ì„œ(7x7 input, 3x3 filter) strideê°€ 2ì´ë¼ë©´ 3x3 ì˜ outputì´ ì¶œë ¥ë©ë‹ˆë‹¤. 

ì´ë•Œ ê°™ì€ ì˜ˆì œì—ì„œ strideê°€ 3ì´ë¼ë©´ ì–´ë–»ê²Œ ë ê¹Œìš”? 

![image-20210329131847661](https://github.com/happy-jihye/happy-jihye.github.io/blob/master/_posts/cs231n/images/lec5/image-20210329131847661.png?raw=1)

<u>outputì´ ìƒì„±ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤ !</u> 

ë”°ë¼ì„œ ì´ ê²½ìš°ì—ëŠ” padding ì„ í•´ì„œ strideê°€ ë§ì§€ ì•ŠëŠ” ê²½ìš°ì—ë„ ì •ìˆ˜ì°¨ì›ì˜ outputì´ ìƒê¸°ë„ë¡ ë§Œë“¤ì–´ì¤ë‹ˆë‹¤.

> ìœ„ì˜ **output size** ê³µì‹ì€ ì¤‘ìš”í•˜ë‹ˆ ì˜ ë´ë‘ì‹œê¸¸ ë°”ëë‹ˆë‹¤ :)

  

### 4) Padding

![img](https://miro.medium.com/max/395/1*1okwhewf5KCtIPaFib4XaA.gif)

![image-20210329132052198](https://github.com/happy-jihye/happy-jihye.github.io/blob/master/_posts/cs231n/images/lec5/image-20210329132052198.png?raw=1)



>  ë‹¤ìŒì˜ ì˜ˆì œì—ì„œ outputì€ 7x7x3ì´ ë ê¹Œìš”, 7x7x1ì´ ë ê¹Œìš”?
>
> - ì •ë‹µì€ **7 x 7 x "í•„í„°ì˜ ê°œìˆ˜"** ì…ë‹ˆë‹¤.
> - ê° filterê°€ ëª¨ë“  depthì— ëŒ€í•´ ë‚´ì ì„ ì·¨í•˜ê¸° ë•Œë¬¸ì— ê° filterì˜ ê²°ê³¼ê°’ì€ 7 x 7 x 1ì´ë©°, activation mapì˜ depthëŠ” filterì˜ ê°œìˆ˜ê°€ ë©ë‹ˆë‹¤.

  

paddingì˜ ì¢…ë¥˜ë¡œëŠ” zero-padding ë§ê³ ë„ ì—¬ëŸ¬ ê°œê°€ ìˆìŠµë‹ˆë‹¤. ì´ì— ëŒ€í•´ì„œëŠ” ë‹¤ìŒì— ë” ìì„¸íˆ ì„¤ëª…ë“œë¦¬ê² ìŠµë‹ˆë‹¤. ë˜í•œ, paddingì„ í•˜ëŠ” ì´ìœ ëŠ” ë³´í†µ ì‚¬ì´ì¦ˆë¥¼ ìœ ì§€í•˜ê³  ì‹¶ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤. 

filterë¥¼ ê±¸ì³ ê³„ì‚°ì„ í•˜ë©´ outputì˜ sizeê°€ ëŒ€ê²Œ ì¤„ì–´ë“œëŠ”ë°, ì—¬ëŸ¬ë²ˆ í•™ìŠµì„ í•´ë„ ì´ë¯¸ì§€ì˜ ì‚¬ì´ì¦ˆë¥¼ ì¤„ì´ê³  ì‹¶ì§€ ì•Šì€ ê²½ìš°ì— paddingì„ ì‚¬ìš©í•˜ê³¤ í•©ë‹ˆë‹¤.

  

  

![image-20210329134304556](https://github.com/happy-jihye/happy-jihye.github.io/blob/master/_posts/cs231n/images/lec5/image-20210329134304556.png?raw=1)

  

ì¦‰, paddingì„ í•˜ì§€ ì•ŠëŠ”ë‹¤ë©´ ë§¤ë²ˆ ê° ì½”ë„ˆì— ìˆëŠ” ê°’ë“¤ì„ ê³„ì‚°í•˜ì§€ ëª»í•˜ê¸° ë•Œë¬¸ì— activation mapì˜ ì‚¬ì´ì¦ˆëŠ” ê³„ì†í•´ì„œ ì¤„ì–´ë“¤ ê²ƒì…ë‹ˆë‹¤. 

ë”°ë¼ì„œ ìš°ë¦¬ëŠ” <u>paddingì„ í†µí•´ ì¶œë ¥ ì‚¬ì´ì¦ˆë¥¼ ìœ ì§€ì‹œì¼œì£¼ë©° í•„í„°ì˜ ì¤‘ì•™ì´ ë‹¿ì§€ ì•ŠëŠ” ê³³ì—ì„œë„ ì—°ì‚°ì„ í•  ìˆ˜ ìˆê²Œ ë©ë‹ˆë‹¤.</u>

![image-20210329133841302](https://github.com/happy-jihye/happy-jihye.github.io/blob/master/_posts/cs231n/images/lec5/image-20210329133841302.png?raw=1)



â­ Filterë‹¹ íŒŒë¼ë¯¸í„°ì˜ ê°œìˆ˜ë¥¼ ì…€ ë•Œ bias termë„ ìˆë‹¤ëŠ” ê±¸ ì£¼ì˜í•˜ì„¸ìš” !

![image-20210329135533525](https://github.com/happy-jihye/happy-jihye.github.io/blob/master/_posts/cs231n/images/lec5/image-20210329135533525.png?raw=1)

  

  

---

### 5) 1 x 1 Convolution layer

![image-20210329135706879](https://github.com/happy-jihye/happy-jihye.github.io/blob/master/_posts/cs231n/images/lec5/image-20210329135706879.png?raw=1)

ìš°ë¦¬ëŠ” `1 x 1ì˜ conv layer`ë„ ì‚¬ìš©í•˜ê³¤ í•©ë‹ˆë‹¤. ì´ë•ŒëŠ” `5x5 conv layer`ì²˜ëŸ¼ ê³µê°„ì ì¸ ì •ë³´ë¥¼ ì´ìš©í•˜ì§€ëŠ” ì•Šì§€ë§Œ,ì—¬ì „íˆ depthë§Œí¼ì˜ ë‚´ì  ì—°ì‚°ì„ ìˆ˜í–‰í•˜ê¸° ë•Œë¬¸ì— ì¶œë ¥ìœ¼ë¡œëŠ” 56 x 56 x 32ê°€ ë‚˜ì˜µë‹ˆë‹¤.

  

**Exampe : Conv layer**

| Torch                                                        | Caffe                                                        |
| ------------------------------------------------------------ | ------------------------------------------------------------ |
| ![image-20210329135830004](https://github.com/happy-jihye/happy-jihye.github.io/blob/master/_posts/cs231n/images/lec5/image-20210329135830004.png?raw=1) | ![image-20210329135834831](https://github.com/happy-jihye/happy-jihye.github.io/blob/master/_posts/cs231n/images/lec5/image-20210329135834831.png?raw=1) |



![image-20210329140352752](https://github.com/happy-jihye/happy-jihye.github.io/blob/master/_posts/cs231n/images/lec5/image-20210329140352752.png?raw=1)

![image-20210329140543690](https://github.com/happy-jihye/happy-jihye.github.io/blob/master/_posts/cs231n/images/lec5/image-20210329140543690.png?raw=1)



Conv LayerëŠ” í•˜ë‚˜ì˜ ë‰´ëŸ°ì€ í•œ ë¶€ë¶„ë§Œ ì²˜ë¦¬í•˜ê³  ê·¸ëŸ° ë‰´ëŸ°ë“¤ì´ ëª¨ì—¬ì„œ ì „ì²´ì˜ ì´ë¯¸ì§€ë¥¼ ì²˜ë¦¬í•œë‹¤ëŠ” ì ì—ì„œ ì‹ ê²½ë§ê³¼ ë§¤ìš° ìœ ì‚¬í•©ë‹ˆë‹¤. 

ìš°ë¦¬ëŠ” **Conv Layerë¥¼ ì‚¬ìš©í•˜ì—¬ spatial structureì„ ìœ ì§€í•œ ì±„ë¡œ layerì˜ ì¶œë ¥ì¸ activation mapì„ ë§Œë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.**

![image-20210329140621370](https://github.com/happy-jihye/happy-jihye.github.io/blob/master/_posts/cs231n/images/lec5/image-20210329140621370.png?raw=1)

ìœ„ì˜ íŒŒë€ìƒ‰ì€ outputì…ë‹ˆë‹¤. filterê°€ ì´ 5ì¢…ë¥˜ë¼ë©´ outputì˜ depthëŠ” 5ê°œ ë˜ë©°, ì´ <u>5ê°œì˜ ì ì€ ê°™ì€ ì§€ì—­ì—ì„œ ì¶”ì¶œëœ ì„œë¡œ ë‹¤ë¥¸ íŠ¹ì§•ë“¤ì´ë¼ê³  ë³´ì‹œë©´ ë©ë‹ˆë‹¤.</u>

  

## 2. Pooling Layer

![image-20210329141005221](https://github.com/happy-jihye/happy-jihye.github.io/blob/master/_posts/cs231n/images/lec5/image-20210329141005221.png?raw=1)

pooling layerê°€ í•˜ëŠ” ì¼ì€ ê°„ë‹¨í•©ë‹ˆë‹¤. ì´ë¯¸ì§€ë¥¼ ê³µê°„ì ìœ¼ë¡œ **Downsample**í•©ë‹ˆë‹¤. (poolingì€ ì¶œë ¥ ì‚¬ì´ì¦ˆë¥¼ ì¤„ì´ê¸° ìœ„í•œ ê¸°ë²•ì´ë¯€ë¡œ ë³´í†µ paddingì„ ì‚¬ìš©í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.)

pooling layerëŠ” **depth**ì—ëŠ” ì˜í–¥ì„ ì£¼ì§€ ì•Šìœ¼ë©°, Max-poolingì„ ê°€ì¥ ë§ì´ ì‚¬ìš©í•©ë‹ˆë‹¤.

![image-20210329141400231](https://github.com/happy-jihye/happy-jihye.github.io/blob/master/_posts/cs231n/images/lec5/image-20210329141400231.png?raw=1)

pooling layerì—ì„œë„ filterë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤. poolingì€ ê¸°ë³¸ì ìœ¼ë¡œ downsampleì„ í•˜ê¸° ìœ„í•œ layerì´ë¯€ë¡œ ê²¹ì¹˜ì§€ ì•Šê²Œ ì„¤ì •ì„ í•˜ë©°, ìš°ë¦¬ëŠ” filterì˜ í¬ê¸°ë§Œí¼ input layerì„ ì§€ì—­ì ìœ¼ë¡œ ì‚´í´ë³´ê³¤ í•©ë‹ˆë‹¤.

`avg pooling`ë„ ì‚¬ìš©í•˜ì§€ë§Œ `Max pooling`ì€ ê·¸ ì§€ì—­ì´ ì–´ë–¤ ì‹ í˜¸ì— ëŒ€í•´ ì–¼ë§ˆë‚˜ í™œì„±í™”ë˜ì—ˆëŠ”ì§€ë¥¼ ì•Œë ¤ì£¼ëŠ” ì§€í‘œì´ë¯€ë¡œ, ë³´í†µ max poolingì„ ë§ì´ ì‚¬ìš©í•˜ê³¤ í•©ë‹ˆë‹¤. (ê·¸ ê°’ì´ ì–´ë””ì— ìˆì—ˆëŠ”ì§€ ë³´ë‹¤ëŠ” ì–¼ë§ˆë‚˜ í°ì§€ê°€ ì¤‘ìš”)



> ì‚¬ì‹¤ poolingì´ë‚˜ strideë‚˜ í•˜ëŠ” ì¼ì€ ë¹„ìŠ·í•©ë‹ˆë‹¤. ìš”ì¦˜ì€ ê·¸ë˜ì„œ strideë¥¼ pooling ëŒ€ì‹ ìœ¼ë¡œ ì‚¬ìš©í•˜ê³¤ í•©ë‹ˆë‹¤.(ì„±ëŠ¥ì´ ë” ì¢‹ê¸°ë„)

  

## 3. Fully Connected Layer (FC layer)

![image-20210329142019544](https://github.com/happy-jihye/happy-jihye.github.io/blob/master/_posts/cs231n/images/lec5/image-20210329142019544.png?raw=1)



FC Layerì—ì„œëŠ” 3ì°¨ì›ì˜ ì¶œë ¥ê°’ì„ ì „ë¶€ stretchí•´ì„œ 1ì°¨ì›ì˜ vectorë¡œ ë§Œë“­ë‹ˆë‹¤. ì¦‰, ì´ layerë¶€í„°ëŠ” spatial structureì„ ê³ ë ¤í•˜ì§€ ì•Šê³  scoreë¡œ ìµœì¢…ì ì¸ ì¶”ë¡ ì„ í•˜ê²Œ ë©ë‹ˆë‹¤.



- ë‹¤ìŒì€ CIFAR-10ì˜ demoì…ë‹ˆë‹¤.

  https://cs.stanford.edu/people/karpathy/convnetjs/demo/cifar10.html





## â­ Summary 

- ConvNetsì€ CONV, POOL, FC layersë¥¼ ìŒ“ì•„ ì˜¬ë ¤ì„œ ë§Œë“¤ì–´ì§‘ë‹ˆë‹¤.
- ë„¤íŠ¸ì›Œí¬ì˜ filterëŠ” ì ì  ì‘ì•„ì§€ê³ , architectureì˜ depthëŠ” ì ì  ê¹Šì–´ì§‘ë‹ˆë‹¤.
- ìµœê·¼ì—ëŠ” POOL/FC layerë¥¼ ì—†ì• ê³  CONV layerë§Œì„ ê¹Šê²Œ ë‚¨ê¸°ëŠ” ì¶”ì„¸ì…ë‹ˆë‹¤. 







---

  



ì˜ˆì „ì— í•™êµ í”„ë¡œì íŠ¸ì—ì„œ verilog ë¡œ CNN Accelerator(ê°€ì†ê¸°)ë¥¼ ë§Œë“  ì ì´ ìˆì—ˆëŠ”ë°,  ê´€ë ¨ ë‚´ìš©ë„ ê¸°íšŒê°€ ë˜ë©´ í¬ìŠ¤íŒ… í•˜ê² ìŠµë‹ˆë‹¤ :)

ê·¸ëŸ¼ ì €í¬ëŠ” 6ê°•ì—ì„œ ëµ™ê² ìŠµë‹ˆë‹¤. ê¶ê¸ˆí•œ ì ì´ ìˆìœ¼ì‹œë‹¤ë©´ ëŒ“ê¸€ ë‚¨ê²¨ì£¼ì„¸ìš” ğŸ˜Š

