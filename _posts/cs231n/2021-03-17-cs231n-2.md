---
date: 2021-03-06
title: "[CS231n] 02. Image Classfication pipeline"

excerpt: "(1) Image classfication(nn/k-nn) (2) Linear Classification"

categories: 
  - cs231n
tags: 
  - cs231n
  - vision
# ëª©ì°¨
toc: true  
toc_sticky: true 
---

---

**Reference**

- [CS231n ê°•ì˜ë…¸íŠ¸ Convolutional Neural Networks](http://cs231n.github.io/convolutional-networks/)

- Lecture 02 - [( Slide Link,](http://cs231n.stanford.edu/slides/2017/cs231n_2017_lecture2.pdf) [,Youtube Link )](https://www.youtube.com/watch?v=OoUX-nOEjG0&list=PLC1qU-LWwrF64f4QKQT-Vg5Wr4qEE1Zxk&index=2)

- [ğŸŒº Happy-Jihye / CS 231n ê°•ì˜ ë…¸íŠ¸](https://happy-jihye.github.io/cs231n/cs231n-0/)

---



## Image Classification

> ### Difficults
>
> (1)  Semantic Gap (ì»´í“¨í„°ëŠ” ì´ë¯¸ì§€ë¥¼ í”½ì…€ë“¤ë¡œ ì¸ì‹í•˜ê¸° ë•Œë¬¸ì— ì‚¬ë¬¼ì¸ì‹ì´ ì–´ë ¤ì›€)
>
> (2) Viewpoint variation (ì¹´ë©”ë¼ê°€ ì›€ì§ì¼ë•Œë§ˆë‹¤ í”½ì…€ê°’ì´ ë³€í™”)
>
> (3) Illumination (ì¡°ëª…)
>
> (4) Deformation (ë‹¤ì–‘í•œ ìì„¸ë‚˜ í˜•íƒœì— ë”°ë¼ ì´ë¯¸ì§€ ë¶„ë¥˜ê°€ ì–´ë ¤ìš¸ ìˆ˜ë„ ìˆìŒ)
>
> (5) Occlusion (ê°€ë ¤ì§)
>
> (6) Background Clutter (ë°°ê²½ì´ë‘ ì‚¬ë¬¼ì´ ë¹„ìŠ·í•  ê²½ìš°)
>
> (7) Intraclass variation (ë‹¤ì–‘ì„± ex. ë‹¤ì–‘í•œ ì¢…ì˜ ê³ ì–‘ì´ë“¤)



- image classifier

```python
def classify_image(images):
    # ...
    return class_label
```

- Data-Driven Approach

  ìˆ˜ë§ì€ imageì™€ labelsë“¤ì„ ëª¨ì€ í›„, trainingì„ í•˜ê³ , ì´ ëª¨ë¸ì„ í‰ê°€í•˜ê¸° 

```python
def train(images, labels):
    # machine learning !!
    return model

def predict(model, test_images):
    # ...
    return test_labels
```

  
  
---

## 1. Nearest Neighbor

- training : dataì™€ labelë“¤ì„ ê¸°ì–µí•˜ê¸°ë§Œ! (ë³„ë‹¤ë¥¸ ì¼ì„ í•˜ì§€ëŠ” X)
- Predicting : ìƒˆë¡œìš´ image ì¤‘ ê¸°ì¡´ì˜ imageì™€ ë¹„ìŠ·í•œê²Œ ìˆëŠ”ì§€ë¥¼ ì°¾ì€ í›„ labeling

- Example Dataset : *CIFAR10* 

  - 10 classes/ 50,000 training images/ 10,000 testing images
    <p align="center"><img title = "image" src="https://github.com/happy-jihye/happy-jihye.github.io/blob/master/_posts/cs231n/images/lec2/image-20210303173804674.png?raw=1" width = "500" ></p>
- ì •í™•í•˜ì§€ ì•Šê²Œ ë¶„ë¥˜ë˜ëŠ” ê²ƒë„ ë§ìŒ



### L1 Distance

- ì´ë¯¸ì§€ë¥¼ Pixel-wise ë¡œ ë¹„êµ
  <p align="center"><img src="https://github.com/happy-jihye/happy-jihye.github.io/blob/master/_posts/cs231n/images/lec2/image-20210303175236169.png?raw=1" width = "500" ></p>


**Code**

```python
import numpy as np

class NearestNeighbor:
    def __init__(self):
        pass
    
    # Memorize training data (just remembers all the training data)
    def training(self, X, y):
        self.xtr = X 	# X : matrix (N x D)
        self.ytr = y	# y : matrix (1 x N)
	
    def predict(self, X):
        num_test = X.shape[0]
        Ypred = np.zeros(num_test, dtype = self.ytr.dtype)
        
        for i in xrange(num_test):
            # using the L1 distance
            # -> for each test image, find closet train image
            distances = np.sum(np.abs(self.xtr - X[i,:]), axis = 1)
            min_index = np.argmin(distances)
            Ypred[i] = self.ytr[min_index]
        
        return Ypred 
    
```

- N examples -> Train O(1), Predict O(n)

- ë³´í†µ Trainingì´ ì˜¤ë˜ê±¸ë¦¬ëŠ” ê±´ ê´œì°®ì§€ë§Œ, testëŠ” ë¹ ë¥´ê²Œ í•´ì•¼í•¨. but NearestNeighbor ëŠ” ë°˜ëŒ€ì„.

  (CNNì€ Trainingì´ ì˜¤ë˜ TestëŠ” ë¹¨ë¦¬)

    
  
> #### *NNì•Œê³ ë¦¬ì¦˜ì„ ì‹¤ì œë¡œ ì ìš©í•˜ë©´?* 
>
> <p align="center"><img src="https://github.com/happy-jihye/happy-jihye.github.io/blob/master/_posts/cs231n/images/lec2/image-20210305172021148.png?raw=1" width = "300" ></p>
>
> - ì ì€ í•™ìŠµ ë°ì´í„°, ì ì˜ ìƒ‰ê¹”ì„ class label
> - ê° ì¢Œí‘œê°€ ì–´ë–¤ í•™ìŠµ ë°ì´í„°ì™€ ê°€ì¥ ê°€ê¹Œìš´ì§€ë¥¼ ê³„ì‚°í•œ í›„ì— ê·¸ í•™ìŠµë°ì´í„°ì˜ labelì„ ë°˜í™˜
> - NNë¶„ë¥˜ê¸°ëŠ” spaceì— ë”°ë¼ ë°ì´í„°ë¥¼ ë¶„ë¥˜
> - *ë¬¸ì œì *
>   - ex) ìœ„ì˜ ì˜ˆì œì˜ ì´ˆë¡ìƒ‰ label ì‚¬ì´ì— ë…¸ë€ìƒ‰ label(noise)
>   - ìœ ì‚¬í•œ ì• ë“¤ë¼ë¦¬ ë¬¶ìœ¼ë ¤ê³  í•˜ë‹¤ë³´ë‹ˆ ìœ„ì™€ ê°™ì€ noiseë“¤ì´ ìƒê¹€..


---

## 2. K-Nearest Neighbors

<p align="center"><img src="https://github.com/happy-jihye/happy-jihye.github.io/blob/master/_posts/cs231n/images/lec2/image-20210305190849027.png?raw=1" width = "450" ></p>

- Distance metricì„ ì´ìš©í•˜ì—¬ ê°€ê¹Œìš´ ì´ì›ƒì„ Kê°œ ë§Œí¼ ì°¾ê³  íˆ¬í‘œ
- ê³ ë¦½ëœ ì ì´ ì—†ì–´ì§€ê³ , ê²½ê³„ë“¤ì€ ë¶€ë“œëŸ¬ì›Œì§
- í°ìƒ‰ ì˜ì—­ : k-nnì´ ê²°ì •í•  ìˆ˜ ì—†ëŠ” ì˜ì—­(ì–´ë–¤ì‹ìœ¼ë¡œë„ ì¶”ë¡ ì„ í•˜ê±°ë‚˜ ì„ì˜ë¡œ ì •í•  ìˆ˜ ìˆìŒ)

* *K-nn ì€ ê·¸ë‹¥ ì„±ëŠ¥ì´ ì¢‹ì§€ëŠ” ì•ŠìŒ*
  

### Distance Metric

<p align="center"><img src="https://github.com/happy-jihye/happy-jihye.github.io/blob/master/_posts/cs231n/images/lec2/image-20210305191436399.png?raw=1" width = "500" ></p>

- L1ì€ ì–´ë–¤ ì¢Œí‘œê³„ë¥¼ ì‚¬ìš©í•˜ëƒì— ë”°ë¼ ê°’ì´ ë°”ë€Œì§€ë§Œ,
- L2ëŠ” ì›ì ì„ ê¸°ì¤€ìœ¼ë¡œ ëª¨ë“  ê±°ë¦¬ê°€ ê°™ê¸° ë•Œë¬¸ì— ì¢Œí‘œê³„ì— ë”°ë¼ ê°’ì´ ë°”ë€Œì§€ ì•ŠìŒ.

- ë§Œì•½ input featureê°€ ê°œë³„ì ì¸ ì˜ë¯¸ë¥¼ ê°€ì§€ê³  ìˆë‹¤ë©´(ex, í‚¤ / ëª¸ë¬´ê²Œ) L1ì´ ì¢‹ì§€ë§Œ
-  input featureê°€ ì¼ë°˜ì ì¸ ë²¡í„°ì´ê³  ì‹¤ì§ˆì ì¸ ì˜ë¯¸ë¥¼ ê°€ì§€ê³  ìˆì§€ ì•Šë‹¤ë©´ L2ê°€ ì¢‹ì„ ê²ƒ

### K-nn : Distance Metric

<p align="center"><img src="https://github.com/happy-jihye/happy-jihye.github.io/blob/master/_posts/cs231n/images/lec2/image-20210305191932390.png?raw=1" width = "500" ></p>

- L1ì€ ì¢Œí‘œì¶•ì˜ ì˜í–¥ì„ ë°›ê¸° ë•Œë¬¸ì— boundaryê°€ ë¶€ìì—°ìŠ¤ëŸ¬ì›€
- L2ì€ ì¢Œí‘œì¶•ê³¼ ë¬´ê´€í•˜ê¸° ë•Œë¬¸ì— ê²½ê³„ê°€ ì¡°ê¸ˆë” ë¶€ë“œëŸ¬ì›€
- [ì´ ë§í¬](http://vision.stanford.edu/teaching/cs231n-demos/knn/) ë¥¼ í†µí•´ ì‹¤í—˜ ê°€ëŠ¥


---
  
## 3. Hyperparameters

- Train timeì— í•™ìŠµì‹œí‚¤ì§€ ì•ŠëŠ” íŒŒë¼ë¯¸í„°
- í•™ìŠµ ì „ì— ë°˜ë“œì‹œ ì„ íƒì„ í•´ì•¼í•¨ !!
- ex) What is the best value of k to use? What is the best distance to use?

- ì§ì ‘ ì‹¤í—˜ì„ í•˜ë©´ì„œ ê°€ì¥ ì¢‹ì€ íŒŒë¼ë¯¸í„°ë¥¼ ì°¾ëŠ” ìˆ˜ë°–ì— ì—†ìŒ. (ë‚´ ì‹¤í—˜ì— ë§ëŠ” íŒŒë¼ë¯¸í„°)
    
  <p align="center"><img src="https://github.com/happy-jihye/happy-jihye.github.io/blob/master/_posts/cs231n/images/lec2/image-20210305194252917.png?raw=1" width = "550" ></p> 
  
- ë‹¤ì–‘í•œ íŒŒë¼ë¯¸í„°ë¡œ trainingì„ í•œ í›„ validation setì—ì„œ ê°€ì¥ ì¢‹ì•˜ë˜ classifierë¥¼ ì„ íƒ -> ì´ë¥¼ ê°€ì§€ê³  testë¥¼ í•˜ê¸° !!

- ë…¼ë¬¸ì„ ì“¸ ë•Œ test setì€ ë§ˆì§€ë§‰ì— í•œë²ˆë§Œ ì‚¬ìš©í•˜ê¸° !(ê·¸ë˜ì•¼ ê³µì •í•œ í‰ê°€ê°€ ê°€ëŠ¥)

- **idea 4 : Cross-Validation**
    
    <p align="center"><img src="https://github.com/happy-jihye/happy-jihye.github.io/blob/master/_posts/cs231n/images/lec2/image-20210305194555149.png?raw=1" width = "500" ></p>
  -  training dataë¥¼ ì—¬ëŸ¬ partitionìœ¼ë¡œ ë‚˜ëˆˆ í›„ validation setì„ ê³„ì† ë°”ê¿”ê°€ë©´ì„œ ìµœì ì˜ í•˜ì´í¼íŒŒë¼ë¯¸í„° ì°¾ëŠ” ë°©ë²•
  - datasetì´ ì‘ë‹¤ë©´ ì“°ì§€ë§Œ, ë”¥ëŸ¬ë‹ì€ ë°ì´í„°ì–‘ ìì²´ê°€ ë°©ëŒ€í•˜ê¸° ë•Œë¬¸ì— ìœ„ì˜ ë°©ë²•ì„ ì‚¬ìš©í•˜ì§€ ì•ŠìŒ



> #### imageì—ì„œëŠ” k-NNì„ ì‚¬ìš©í•˜ì§€ ì•ŠìŒ 
>
> - k-nnì´ ë„ˆë¬´ ëŠë¦¼,,
> - L1/L2ê°€ ì´ë¯¸ì§€ê°„ ê±°ë¦¬ë¥¼ ì¸¡ì •í•˜ê¸°ì— ì ì ˆí•˜ì§€ ì•ŠìŒ
> - **Curse of dimensionality**
>   - k-nnì€ training dataë¥¼ ì´ìš©í•´ì„œ ê³µê°„ì„ ë¶„í• í–ˆì—ˆìŒ. ì¦‰, k-nnì´ ì˜ ë™ì‘í•˜ë ¤ë©´ ì „ì²´ ê³µê°„ì„ ì¡°ë°€í•˜ê²Œ ì»¤ë²„í• ë§Œí¼ì˜ ë°ì´í„°ê°€ í•„ìš”í•¨..
>   - ì¦‰, ì¶©ë¶„í•œ ì–‘ì˜ í•™ìŠµë°ì´í„°ê°€ í•„ìš”í•œë° ì´ í•™ìŠµë°ì´í„°ëŠ” ì°¨ì›ì´ ì¦ê°€í•¨ì—ë”°ë¼ ê¸°í•˜ê¸‰ìˆ˜ì ìœ¼ë¡œ ì¦ê°€í•¨.
>     <p align="center"><img src="https://github.com/happy-jihye/happy-jihye.github.io/blob/master/_posts/cs231n/images/lec2/image-20210305200123067.png?raw=1" width = "500" ></p>
>   - ìœ„ì˜ ê·¸ë¦¼ë“¤ì—ì„œ ì  í•˜ë‚˜í•˜ë‚˜ê°€ training sample.
>   - 1ì°¨ì›ì—ì„œëŠ” 4ê°œì˜ ë°ì´í„°ë§Œ ìˆìœ¼ë©´ ë˜ì§€ë§Œ, 3ì°¨ì›ì—ì„œëŠ” ë§ì€ ë°ì´í„°ê°€ í•„ìš”í•˜ê²Œ ë¨.



## â­ Summary 

- In Image classification we start with a training set of images and labels, and must predict labels on the test set 
- The K-Nearest Neighbors classifier predicts labels based on nearest training examples 
- Distance metric and K are hyperparameters
- Choose hyperparameters using the validation set; only run on the test set once at the very end!



---



## Linear Classfication

- NNì€ ë ˆê³ ë¸”ëŸ­ê³¼ ê°™ê³ , Linear Classificationì€ ê¸°ë³¸ ë¸”ëŸ­ê³¼ ê°™ìŒ
- CNNì„ í†µí•´ ì´ë¯¸ì§€ë¥¼ ì²˜ë¦¬í•œ í›„ì—, RNNì„ í†µí•´ ì´ë¯¸ì§€ì— ëŒ€í•œ ì„¤ëª…ì„ ë½‘ì•„ëƒ„

<p align="center"><img src="https://github.com/happy-jihye/happy-jihye.github.io/blob/master/_posts/cs231n/images/lec2/image-20210305201007375.png?raw=1" width = "500" ></p>



## Parametric Appoach

#### CIFAR 10 

- k-nnì€ íŒŒë¼ë¯¸í„°ê°€ ì—†ì—ˆìŒ. ëª¨ë“  íŠ¸ë ˆì´ë‹ì…‹ì„ test timeì— ì‚¬ìš©í–ˆì—ˆìŒ(-> test timeì´ ì˜¤ë˜ ê±¸ë¦¼)
- parametric approachì—ì„œëŠ” training dataì˜ ì •ë³´ë¥¼ ìš”ì•½í•œ í›„ ì´ë¥¼ íŒŒë¼ë¯¸í„° ê°€ì¤‘ì¹˜ì— ì €ì¥ -> test timeì´ ì ê²Œ ê±¸ë¦¼
- ë”¥ëŸ¬ë‹ì€ testë¥¼ ë¹ ë¥´ê²Œ í•´ì•¼í•˜ê¸° ë•Œë¬¸ì— ì´ í•¨ìˆ˜ë¥¼ ì˜ ì„¤ê³„í•´ì•¼í•¨ !!





<p align="center"><img src="https://github.com/happy-jihye/happy-jihye.github.io/blob/master/_posts/cs231n/images/lec2/image-20210305201202039.png?raw=1" width = "500" ></p>

- ë°ì´í„°ì…‹ì´ ë¶ˆê· í˜•í•œ ê²½ìš°(ex, ê°œë³´ë‹¤ ê³ ì–‘ì´ ë°ì´í„°ê°€ ë§ì„ ë•Œ) ê³ ì–‘ì´ í´ë˜ìŠ¤ì— í•´ë‹¹í•˜ëŠ” ë°”ì´ì–´ìŠ¤ê°€ ì»¤ì§€ê²Œ ë¨.
  <p align="center"><img src="https://github.com/happy-jihye/happy-jihye.github.io/blob/master/_posts/cs231n/images/lec2/image-20210305201807926.png?raw=1" width = "500" ></p>
- score : ì´ë¯¸ì§€ì˜ í”½ì…€ê°’ê³¼ ê°€ì¤‘ì¹˜ í–‰ë ¬ì„ ë‚´ì í•œ ê°’ì— bias termì„ ë”í•œ ê²ƒ
  - ë‚´ì  : í´ë˜ìŠ¤ê°„ í…œí”Œë¦¿ì˜ ìœ ì‚¬ë„ë¥¼ ì¸¡ì •í•˜ëŠ” ê²ƒê³¼ ìœ ì‚¬
  - bias : ë°ì´í„° ë…ë¦½ì ìœ¼ë¡œ ê° í´ë˜ìŠ¤ì— scailing offsetì„ ë”í•¨
- linear classification = í…œí”Œë¦¿ ë§¤ì¹­ê³¼ ë¹„ìŠ·

- ê°€ì¤‘ì¹˜ ë²¡í„°ë¥¼ ì‹œê°í™”í•œê²ƒ

  <p align="center"><img src="https://github.com/happy-jihye/happy-jihye.github.io/blob/master/_posts/cs231n/images/lec2/image-20210306095327199.png?raw=1" width = "500" ></p>

- Linear classifier : ê³ ì°¨ì› ê³µê°„ì— ì„ í˜•ì ì¸ ê²½ê³„ë¥¼ ê·¸ì–´ ì´ë¯¸ì§€ë¥¼ ë¶„ë¥˜í•˜ëŠ” ê²ƒ

  <p align="center"><img src="https://github.com/happy-jihye/happy-jihye.github.io/blob/master/_posts/cs231n/images/lec2/image-20210306095626711.png?raw=1" width = "500" ></p>




> ë‹¤ìŒê³¼ ê°™ì€ ê²½ìš°ì—ëŠ” linear classificationìœ¼ë¡œ ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸°ê°€ ì–´ë ¤ì›€
>
> - Parity problem
> - Multimodal problem(ë§¨ ì˜¤ë¥¸ìª½)
>   - multimodal dataë¼ë©´ í•˜ë‚˜ì˜ í´ë˜ìŠ¤ê°€ ì—¬ëŸ¬ ê³µê°„ì— ë¶„í¬í•  ìˆ˜ ìˆìŒ
>
> <p align="center"><img src="https://github.com/happy-jihye/happy-jihye.github.io/blob/master/_posts/cs231n/images/lec2/image-20210306095757349.png?raw=1" width = "500" ></p>

