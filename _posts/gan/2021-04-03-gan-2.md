---
title: "[Paper Review] DCGAN : Unsupervised Representation Learning with Deep Convolutional Generative Adversarial Networks ë…¼ë¬¸ ë¶„ì„"
excerpt: "GANì— Convolutional Neural Networkë¥¼ ì ìš©í•œ DCGAN(Deep Convolutional Generative Adeversarial Networks)ì— ëŒ€í•´ ì•Œì•„ë³¸ë‹¤"

date: 2021-04-04
categories:
 - GAN
tags:
  - deeplearning
  - ai
  - pytorch
  - GAN
  - vision
search: true

# ëª©ì°¨
toc: true  
toc_sticky: true 

use_math: true
---


> ì´ë²ˆ í¬ìŠ¤íŒ…ì—ì„œëŠ” GANì— Convolutional Neural Networkë¥¼ ì ìš©í•œ **DCGAN(Deep Convolutional Generative Adeversarial Networks)**ì— ëŒ€í•´ ì‚´í´ë³¸ë‹¤.

- Paper : [Unsupervised Representation Learning with Deep Convolutional Generative Adversarial Networks](https://arxiv.org/abs/1511.06434)
          (2015 / Alec Radford, Luke Metz, Soumith Chintala)

- [GAN-Zoos! (GAN í¬ìŠ¤íŒ… ëª¨ìŒì§‘)](https://happy-jihye.github.io/gan/)
          
## 1. Introduction

ì´ ë…¼ë¬¸ì´ ë‚˜ì˜¨ ì‹œì  ì´ì „ê¹Œì§€ ì»´í“¨í„°ë¹„ì „ ë¶„ì•¼ì—ì„œëŠ” CNNì„ í™œìš©í•œ supervised learning ì—°êµ¬ê°€ ì§€ë°°ì ì´ì—ˆë‹¤. ì´ë•Œì—ë„ CNNì„ unsupervisedì— ì ìš©ì‹œí‚¤ë ¤ëŠ” ë§ì€ ë…¸ë ¥ë“¤ì´ ìˆì—ˆì§€ë§Œ, ê´€ë ¨ ì—°êµ¬ë“¤ì´ ì¢‹ì€ ì„±ê³¼ë¥¼ ë‚´ì§€ ëª»í–ˆì—ˆë‹¤.

<p align="center"><img src="https://github.com/happy-jihye/GAN/blob/main/images/gan3.png?raw=1" width = "500" ></p>


**ì´ì•ˆ êµ¿ íŒ°ë¡œìš°ê°€ ì œì•ˆí•œ [GAN(2014)](https://arxiv.org/abs/1406.2661)ì€ SoTAì˜ ê²°ê³¼ë¥¼ ëƒˆì—ˆê³ , discriminatorì™€ generator ë‘˜ì´ ê²½ìŸì„ í•´ì„œ likelihoodë¥¼ maximizeí•˜ë ¤ëŠ” ê¸°ë²• ìì²´ë„ êµ‰ì¥íˆ ì¬ë¯¸ë‚œ ì•„ì´ë””ì–´ì—¬ì„œ ë§ì€ ì£¼ëª©ì„ ë°›ì•˜ì—ˆë‹¤.**
(Generatorê°€ ìƒì„±í•œ ì´ë¯¸ì§€ì—ì„œ featureë¥¼ ë½‘ì•„ì„œ discriminatorê°€ ê°ë³„ - discriminatorëŠ” supervised taskë¥¼ ìˆ˜í–‰í•œë‹¤. GANì— ëŒ€í•œ ì„¤ëª…ì€ [ì´ ê¸€](https://happy-jihye.github.io/gan/gan-1/)ì„ ì°¸ê³ )


ë‹¤ë§Œ, GANì€ trainingì˜ ê³¼ì •ì´ ë¶ˆì•ˆì •í–ˆê³  ì¢…ì¢… generatorëŠ” nonsensicalí•œ outputì„ ë§Œë“¤ì–´ë‚´ê¸°ë„ í–ˆë‹¤. ë˜í•œ GANì´ ì–´ë–»ê²Œ í•™ìŠµë˜ëŠ”ì§€ë¥¼ visualizeí•˜ê³  ì´í•´í•˜ê¸°ê°€ ì–´ë ¤ì› ë‹¤.

DCGANì€ GANì— Convolutional NN Layerë¥¼ ì ìš©í•˜ì—¬ trainingì„ ì•ˆì •í™”í–ˆê³ , GANì˜ Generatorì™€ Discriminatorì˜ ë‚´ë¶€ ë„¤íŠ¸ì›Œí¬ë¥¼ ì´í•´í•  ìˆ˜ ìˆê²Œ í–ˆë‹¤.


> DCGANì€ GANì„ ì•ˆì •í™”ì‹œì¼°ë‹¤ëŠ” ì ì—ì„œ ì‹œì‚¬ì ì´ í¬ë©°, generatorì™€ discriminatorì˜ êµ¬ì¡°ë¥¼ ì œì‹œí–ˆë‹¤ëŠ” ì ì—ì„œ ë§ì€ ì£¼ëª©ì„ ë°›ì•˜ë‹¤.
> 
> DCGANì€ `Generator`ì—ì„œ íŠ¹ì • filterê°€ ì´ë¯¸ì§€ì˜ ì–´ë–¤ featureë¥¼ í•™ìŠµí•˜ëŠ”ì§€ë¥¼ ë³´ì—¬ì£¼ì—ˆê³ , `Discriminator`ì—ì„œë„ ë‹¤ë¥¸ unsupervised algorithmsê³¼ ë¹„êµí–ˆì„ë•Œ ê½¤ ê´œì°®ì€ image classification ì„±ëŠ¥ì„ ë³´ì˜€ë‹¤.  



---

## 2. Related Work

**2.1 Representation Learning from Unlabeld Data**

**2.2 Generating Natural Images**
- [parametric model / non-parametric model](https://process-mining.tistory.com/131)
- non-parametic model
  - [LAPGAN : Deep Generative Image Models using a Laplacian Pyramid of Adversarial Networks(2015)](https://arxiv.org/abs/1506.05751) : ê³ í•´ìƒë„ì˜ ì´ë¯¸ì§€ë¥¼ ìƒì„±
  - [DRAW: A Recurrent Neural Network For Image Generation(2015)](https://arxiv.org/abs/1502.04623)
  - [Learning to generate chairs with convolutional neural networks(2014)](https://arxiv.org/abs/1411.5928)

**2.3 Visualizing the internals of CNNs**



---

## 3. Approach and Model Architecture

â­ **DCGAN**
- ë‹¤ì–‘í•œ datasetì— ëŒ€í•´ trainingì„ ì•ˆì •í™”
- deeper generative model
- higher resolution

---
### DCGAN Architecture

DiscriminatorëŠ” ì¼ë°˜ì ì¸ CNNì„ ì‚¬ìš©í•œë‹¤. Generatorì˜ Convolutional NetworkëŠ” **Transposed Conv**ë¼ëŠ” ì•½ê°„ íŠ¹ì´í•œ êµ¬ì¡°ì˜ CNNì„ ì‚¬ìš©í•˜ëŠ”ë°, í•´ìƒë„ë¥¼ ëŠ˜ë¦¬ëŠ” ë°©í–¥ìœ¼ë¡œ í•™ìŠµì´ ì§„í–‰ëœë‹¤.

- [Transposed Convolutions](https://zzsza.github.io/data/2018/02/23/introduction-convolution/)
<p align="center"><img src="https://github.com/happy-jihye/happy-jihye.github.io/blob/master/_posts/images/gan/dcgan11.gif?raw=1" width = "400" ></p>
  
- ìµœê·¼ ë“¤ì–´ì„œëŠ” DCGANì˜ Transposed Convë³´ë‹¤ëŠ” Resized Convë¥¼ ì“°ëŠ” ì¶”ì„¸!


<p align="center"><img src="https://github.com/happy-jihye/happy-jihye.github.io/blob/master/_posts/images/gan/dcgan1.PNG?raw=1" width = "800" ></p>

> - **Replace any pooling layers with strided convolutions (discriminator) and fractional-strided convolutions (generator).**

[Striving for simplicity: The all convolutional net(2014)](https://arxiv.org/abs/1412.6806) ë…¼ë¬¸ì—ì„œëŠ” max-pooling functionì„ ì—†ì• ê³  strided convolutional layerë¥¼ ì‚¬ìš©í–ˆë‹¤. DCGANì—ì„œëŠ” ì´ ë°©ì‹ì„ ì ìš©ì‹œì¼°ë‹¤.

GeneratorëŠ” max-pooling layer ëŒ€ì‹  **fractional strided convolutions**ì„, DiscriminatorëŠ” **strided convolutions**ì„ ì‚¬ìš©í•œë‹¤.

> - **Remove fully connected hidden layers for deeper architectures.**

ê·¸ë¦¬ê³  <u>ìµœê·¼ CNNì—ì„œëŠ” classifierë¡œì„œ FC Layerë³´ë‹¤ GAP(Global Average Pooling)ì„ ì‚¬ìš©í•˜ëŠ” ì¶”ì„¸ì´ë‹¤.</u> (FC layerëŠ” ì „ì²´ CNNë³´ë‹¤ ë” ë§ì€ parameterë¥¼ ê°€ì§€ê³ , ì—°ì‚°ë„ ì˜¤ë˜ê±¸ë¦¬ê³ , featureì˜ ìœ„ì¹˜ ì •ë³´ë“¤ë„ ì‚¬ë¼ì§€ëŠ” ë‹¨ì ë“¤ì´ ìˆìŒ, GAPì— ê´€í•œ ë‚´ìš©ì€ [ì´ ê¸€](https://jetsonaicar.tistory.com/16) ì°¸ê³ )

- (ì¶”ì¸¡) FC layerë¥¼ ì—†ì• ë©´ ìì—°ìŠ¤ë ˆ dropoutì˜ íš¨ê³¼ë„ ìƒê¸°ê¸° ë•Œë¬¸ì— ì •ê·œí™”ì—ë„ ì¢‹ì„ ê²ƒ ê°™ë‹¤


> - **Use batchnorm in both the generator and the discriminator.**

DCGANì—ì„œëŠ” [Batch Normalization(2015)](https://arxiv.org/abs/1502.03167)ë¥¼ ì¶”ê°€í•œë‹¤. BNì€ ì–´ë–¤ layerë¡œë¶€í„° ë‚˜ì˜¨ batchë‹¨ìœ„ ë§Œí¼ì˜ activationì´ ìˆì„ ë•Œ, ì´ ê°’ì„ unit gaussianìœ¼ë¡œ ë§Œë“¤ì–´ì£¼ê¸° ìœ„í•´ í˜„ì¬ batchì—ì„œ ê³„ì‚°í•œ meanê³¼ varianceë¡œ normalizeë¥¼ ì‹œí‚¤ëŠ” ë°©ë²•ì´ë‹¤. 
ìš”ì¦˜ ê±°ì˜ ëª¨ë“  ë„¤íŠ¸ì›Œí¬ì— ì‚¬ìš©ë˜ëŠ” ë“¯? (ìì„¸í•œ ê¸€ì€ [ì´ ê¸€](https://happy-jihye.github.io/cs231n/cs231n-6/#4-batch-normalization) ì°¸ê³ )

ë…¼ë¬¸ì—ì„œëŠ” BNì„ ì‚¬ìš©í•˜ë©´ GANì˜ ê³ ì§ˆì ì¸ ë¬¸ì œì¸ **Mode Collapsing**ì„ í•´ê²°í•  ìˆ˜ ìˆë‹¤ê³  í•œë‹¤. 

DCGANì—ì„œëŠ” Generatorì˜ outputê³¼ Discriminatorì˜ inputì—ëŠ” BNì„ ì ìš©í•˜ì§€ ì•Šì•˜ë‹¤.


> - **Use ReLU activation in generator for all layers except for the output, which uses Tanh.**
>
> - **Use LeakyReLU activation in the discriminator for all layers.**

<p align="center"><img src="https://github.com/happy-jihye/happy-jihye.github.io/blob/master/_posts/images/gan/dcgan10.png?raw=1" width = "700" ></p>

---

## 4. Details of Adversarial Training

**Dataset**
- Large-scale Scene Understanding (LSUN)
- Imagenet-1k
- Faces 
  - ì´ datasetì€ Facebookì´ ì‚¬ì§„ì„ webì—ì„œ ê°€ì ¸ì™€ì„œ opencvë¡œ ì–¼êµ´ë§Œ ë–¼ì–´ë…¼ ë°ì´í„°ë¼ê³  í•œë‹¤.
  - ë²•ì ìœ¼ë¡œ ë¬¸ì œê°€ ì•ˆë˜ë ¤ë‚˜..?!?ğŸ¤”


**parameterë“¤ì€ ë…¼ë¬¸ 3pë¥¼ ì°¸ê³  !**

## 5. Results

generative image modelì€ training sampleì„ ê¸°ì–µ(memorization)í•˜ê³  overfittingì´ ì˜ ëœë‹¤ëŠ” ë¬¸ì œê°€ ìˆë‹¤. 

DCGANì€ memorizing í˜„ìƒì€ ì•ˆ ë‚˜íƒ€ë‚œë‹¤ê³  ì£¼ì¥í•œë‹¤.

- **LSUN**
  
  | epoch 1                                                      | epoch 5                                                      |
  | ------------------------------------------------------------ | ------------------------------------------------------------ |
  | <img src="https://github.com/happy-jihye/happy-jihye.github.io/blob/master/_posts/images/gan/dcgan2.PNG?raw=1"> | <img src="https://github.com/happy-jihye/happy-jihye.github.io/blob/master/_posts/images/gan/dcgan3.PNG?raw=1"> |


- **Walking in the Latent Space**
  
  GAN modelì—ì„œëŠ” latent spaceì—ì„œ ì›€ì§ì¼ ë•Œ (zê°€ ì•½ê°„ ë³€í•  ë•Œ) ìƒì„±ë˜ëŠ” ì´ë¯¸ì§€ì— ì»¤ë‹¤ë€ ë³€í™”ê°€ ìƒê¸°ë©´ ì•ˆëœë‹¤. 
  ë…¼ë¬¸ì—ì„œëŠ” ì´ë¥¼ **Walking in the Latent Space**ë¼ê³  ë¶€ë¥¸ë‹¤.

  ë…¼ë¬¸ì—ì„œëŠ” ë˜í•œ ì •ë§ë¡œ latent vector `z`ê°€ ì¡°ê¸ˆ ë³€í•˜ë©´ ê²°ê³¼ë„ ì¡°ê¸ˆë§Œ ë³€í•˜ëŠ”ì§€ í™•ì¸í•´ë´¤ë‹¤.

  <p align="center"><img src="https://github.com/happy-jihye/happy-jihye.github.io/blob/master/_posts/images/gan/dcgan4.PNG?raw=1" width = "400" ></p>

  6ë²ˆì§¸ ì¤„ì„ ë³´ë©´, latent vectorë¥¼ ë°”ê¿€ ë•Œ ì°½ë¬¸ì´ ì—†ì–´ì¡Œë‹¤ ìƒê¸´ë‹¤. ì¦‰, ë¶€ë“œëŸ½ê²Œ ë³€í•¨
  
- **Discriminator**

  DCGANì˜ supervised taskë¥¼ í‰ê°€í•˜ê¸° ìœ„í•´ discriminatorë¥¼ **Imagenet-1k** ë¡œ í•™ìŠµì‹œí‚¨ í›„ **CIFAR-10**ìœ¼ë¡œ í‰ê°€í–ˆë‹¤.

  ì•„ë˜ì˜ ê·¸ë¦¼ì„ ë³´ë©´ ì„±ëŠ¥ì€ ì˜ ë‚˜ì˜´ !

  <p align="center"><img src="https://github.com/happy-jihye/happy-jihye.github.io/blob/master/_posts/images/gan/dcgan5.PNG?raw=1" width = "700" ></p>


- **Visualizing the Discriminator Features**
  
  DCGANì˜ ë‚´ë¶€ networkê°€ ì–´ë–»ê²Œ ëŒì•„ê°€ëŠ”ì§€ë¥¼ ë³¼ ìˆ˜ ìˆë‹¤.

  <p align="center"><img src="https://github.com/happy-jihye/happy-jihye.github.io/blob/master/_posts/images/gan/dcgan6.PNG?raw=1" width = "600" ></p>

- **Generator**

  íŠ¹ì • objectë¥¼ ìŠë„ë¡ í•´ë‹¹ filterë¥¼ dropoutì„ í•˜ëŠ” ê²ƒë„ ê°€ëŠ¥

  <p align="center"><img src="https://github.com/happy-jihye/happy-jihye.github.io/blob/master/_posts/images/gan/dcgan7.PNG?raw=1" width = "600" ></p>

- **Vector Arithmetic on Face Samples**

  DCGAN ë…¼ë¬¸ì˜ êµ‰ì¥íˆ ì¬ë°ŒëŠ” ë¶€ë¶„ì´ë‹¤. 
  > $vector(â€Kingâ€) - vector(â€Manâ€) + vector(â€Womanâ€)$  = $vector("Queen")$ ë¥¼ í•˜ëŠ” ê²ƒì´ ê°€ëŠ¥í•˜ë‹¤ !!

  Word to Vectorì— ìˆì—ˆë˜ linearí•œ íŠ¹ì§•ì´ GANì˜ latent spaceì—ì„œë„ ì ìš©ì´ ê°€ëŠ¥í•´ì§.

  <p align="center"><img src="https://github.com/happy-jihye/happy-jihye.github.io/blob/master/_posts/images/gan/dcgan8.PNG?raw=1" width = "500" ></p>

  - ì˜ˆë¥¼ ë“¤ì–´ `ë‚¨ì`ë¥¼ ìƒì„±í•˜ëŠ” ëª¨ë¸ì´ ìˆì„ ë•Œ, ë‚¨ìë¥¼ ìƒì„±í•˜ëŠ” íŠ¹ì§• í•˜ë‚˜ê°€ ìˆëŠ”ê²Œ ì•„ë‹ˆë¼ ì…ì„ ìƒì„±í•˜ëŠ” ë¶€ë¶„, ëˆˆì„ ìƒì„±í•˜ëŠ” ë¶€ë¶„ ì´ëŸ° ì‹ìœ¼ë¡œ ê°ê°ì˜ íŠ¹ì§•ë“¤ì´ ë”°ë¡œë”°ë¡œ í•™ìŠµë˜ê²Œ ëœë‹¤.

  <p align="center"><img src="https://github.com/happy-jihye/happy-jihye.github.io/blob/master/_posts/images/gan/dcgan9.PNG?raw=1" width = "500" ></p>
  
  > âœğŸ» vector arithmeticì„ í•˜ë ¤ë©´ `smiling woman`ê³¼ ê°™ì€ vectorë¥¼ ì°¾ì•„ì•¼í•œë‹¤. (latent spaceì—ì„œ smiling womanì— í•´ë‹¹í•˜ëŠ” distributionì´, neutral womanì— í•´ë‹¹í•˜ëŠ” distributionì´ ìˆì„ ê²ƒ)
  > 
  > DCGAN ë…¼ë¬¸ì—ì„œëŠ” Generatorì— ë„£ì—ˆì„ ë•Œ `smiling woman`ê°€ ë‚˜ì˜¤ëŠ” latent vector `z`ë¥¼ ì°¾ì•˜ë‹¤ê³  ë§í•˜ëŠ”ë°, ì´ ë¶€ë¶„ì— ëŒ€í•œ ì„¤ëª…ì´ ë…¼ë¬¸ì—ëŠ” ì—†ë‹¤. ì–´ë–»ê²Œ smiling womanì— í•´ë‹¹í•˜ëŠ” `z`ë¥¼ ë½‘ì•˜ëŠ”ì§€ ì¶”ì¸¡ì„ í•´ë³´ìë©´, í•™ìŠµì´ ëë‚œ GeneratorëŠ” ê³ ì •ì‹œì¼œë†“ê³ , ìƒì„±ëœ ì´ë¯¸ì§€ë“¤ ì¤‘ smiling womanì— í•´ë‹¹í•˜ëŠ” `x`ë“¤ì„ ë½‘ì€ ë‹¤ìŒì— ì´ë¥¼ back-propagationí•˜ì—¬ input `z`ë¥¼ ë½‘ì•˜ì„ ê±°ë¼ê³  ì¶”ì¸¡í•´ë³¼ ìˆ˜ ìˆë‹¤. ì¦‰, ì—­í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•œ ê²ƒê³¼ ë¹„ìŠ·í•˜ë‹¤.   

## 6. Opinion

> ê¸°ì¡´ì˜ GAN ë…¼ë¬¸ì€ generatorì™€ discriminatorê°€ ê²½ìŸí•˜ë©´ì„œ ì„±ì¥í•˜ëŠ” ê³¼ì •ì— ëŒ€í•´ì„œëŠ” ì˜ ì„¤ëª…ì´ ë˜ì–´ìˆëŠ”ë°, generatorì™€ discriminator ìì²´ì˜ networkì— ëŒ€í•œ ì„¤ëª…ì€ ë¶€ì¡±í•˜ë‹¤ê³  ëŠê»´ì¡Œì—ˆë‹¤.
> 
> DCGANì€ ì´ë¥¼ ì˜ í’€ì–´ë‚¸ ì¢‹ì€ ë…¼ë¬¸ì¸ ê²ƒ ê°™ë‹¤. 
> 
> ë…¼ë¬¸ì„ ì½ë‹¤ë³´ë©´ ì‹¤í—˜ì„ ì—„ì²­ ë§ì´ ëŒë ¤ì„œ ê²°ê³¼ë¥¼ ë‚¸ ê²ƒ ê°™ë˜ë°,, ì—­ì‹œ Facebookì´ë‹¤...
> 
> DCGANì€ GANì˜ ê°œê´„ì¸ ë“¯í•œ ì¸ìƒì„ ë°›ì•˜ë‹¤. ì´ë¥¼ ì ìš©í•œ í›„ì† ì—°êµ¬ë“¤ ì¤‘ ì¬ë¯¸ë‚œ ê²Œ ë§ì„ ê²ƒ ê°™ë‹¤ !ğŸ˜


---

## Reference 

- http://jaejunyoo.blogspot.com/2017/02/deep-convolutional-gan-dcgan-2.html
  

  