---
title: "Kaggle ë”°ë¼ì¡ê¸° #01 : Titanic Tutorial (for Beginner) "
excerpt: "ìºê¸€ ì´ˆë³´ìë¥¼ ìœ„í•œ íƒ€ì´íƒ€ë‹‰ íŠœí† ë¦¬ì–¼ì…ë‹ˆë‹¤."

categories:
 - Kaggle
tags:
 - Kaggle
layout: jupyter
search: true

# ëª©ì°¨
toc: true  
toc_sticky: true 

# ìˆ˜ì‹
use_math: true
---


<p align="right">
  <a href="https://github.com/happy-jihye/Kaggle-Tutorial/blob/main/1-kaggle-tutorial-titanic.ipynb" role="button" target="_blank">
    <img class="notebook-badge-image" src="/assets/badges/github.svg" alt="View On GitHub">
  </a>
  <a href="https://mybinder.org/v2/gh/happy-jihye/Kaggle-Tutorial/main?filepath=1-kaggle-tutorial-titanic.ipynb" target="_blank">
      <img class="notebook-badge-image" src="/assets/badges/binder.svg" alt="Open In Binder"/>
  </a>
  <a href="https://colab.research.google.com/github/happy-jihye/Kaggle-Tutorial/blob/main/1-kaggle-tutorial-titanic.ipynb" target="_blank">
      <img class="notebook-badge-image" src="/assets/badges/colab.svg" alt="Open In Colab"/>
  </a>
</p>




Kaggleì˜ ê°€ì¥ ê¸°ë³¸ì ì¸ íŠœí† ë¦¬ì–¼ì…ë‹ˆë‹¤. kaggleì˜ ì´ˆë³´ìë¶„ë“¤ì€ ì´ íŠœí† ë¦¬ì–¼ì„ í†µí•´ ì‹œì‘í•˜ì‹œëŠ” ê²ƒì„ ì¶”ì²œë“œë¦½ë‹ˆë‹¤.

- [ğŸ˜Š íŠœí† ë¦¬ì–¼ : Kaggleì—ì„œ ë³´ê¸°](https://www.kaggle.com/happyjihye/kaggle-tutorial-titanic/)
- [Kaggle âœğŸ» ìºê¸€ ë”°ë¼ì¡ê¸° ì‹œë¦¬ì¦ˆ](https://happy-jihye.github.io/kaggle/)


> ğŸ†ï¸ **Competition** : [Titanic - Machine Learning from Disaster](https://www.kaggle.com/c/titanic)
>
> â­ **Goal** : íƒ€ì´íƒ€ë‹‰ì—ì„œ ì‚´ì•„ë‚¨ì€ ìŠ¹ê°ì˜ ìˆ˜ë¥¼ ì˜ˆì¸¡í•˜ëŠ” ëª¨ë¸ ë§Œë“¤ê¸°

---

## 1. Import Library

ë°ì´í„° ë¶„ì„ì— í•„ìš”í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ë¶ˆëŸ¬ì˜µë‹ˆë‹¤.


```python
import os

# Data Analysis
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt

# Data Visualization
import seaborn as sns
import missingno as msno

import warnings

# seabornì˜ font scaleì„ ì‚¬ìš©í•˜ì—¬ graphì˜ font sizeë¥¼ ì§€ì •í•©ë‹ˆë‹¤.
plt.style.use('seaborn')
sns.set(font_scale=2.5)

# ignore warnings
warnings.filterwarnings('ignore')

# ë¸Œë¼ìš°ì €ì˜ ë‚´ë¶€ì— plotì„ ê·¸ë¦´ ìˆ˜ ìˆë„ë¡ ì„¤ì •í•©ë‹ˆë‹¤.
%matplotlib inline
```

Machine Learning ë„êµ¬ì¸ **Scikit-Learn**ë¥¼ ë¶ˆëŸ¬ì˜µë‹ˆë‹¤.

- `LogisticRegression` : ë°ì´í„°ê°€ íŠ¹ì • ì¹´í…Œê³ ë¦¬ì— ì†í•´ìˆëŠ”ì§€ì˜ ì—¬ë¶€ë¥¼ 0ì—ì„œ 1ì˜ í™•ë¥ ë¡œ ì˜ˆì¸¡í•˜ëŠ” íšŒê·€ ì•Œê³ ë¦¬ì¦˜ì…ë‹ˆë‹¤.
- `SVM(Support Vector Machine)` : ë°ì´í„°ê°€ íŠ¹ì • ì¹´í…Œê³ ë¦¬ì— ì†í•´ìˆëŠ”ì§€ ì—¬ë¶€ë¥¼ íŒë‹¨í•´ì£¼ëŠ” ì§€ë„í•™ìŠµ ëª¨ë¸ë¡œ, classificationì´ë‚˜ logistic regressionì— ìì£¼ ì‚¬ìš©ë©ë‹ˆë‹¤.
- `Random Forest` : ë‹¤ìˆ˜ì˜ decision tree(ê²°ì •íŠ¸ë¦¬)ë¥¼ í•™ìŠµì‹œí‚¤ëŠ” ensemble machine learningëª¨ë¸ì…ë‹ˆë‹¤.
- `k-nearest neighbors(KNN)` : ì–´ë–¤ ë°ì´í„°ê°€ ì£¼ì–´ì¡Œì„ë•Œ, ì£¼ë³€ì˜ ë°ì´í„°(ì´ì›ƒ)ë“¤ê³¼ í•œ ë²”ì£¼ë¡œ ë¬¶ì–´ì£¼ëŠ” ëª¨ë¸ì…ë‹ˆë‹¤.


```python
from sklearn.linear_model import LogisticRegression
from sklearn.svm import SVC, LinearSVC
from sklearn.ensemble import RandomForestClassifier
from sklearn.neighbors import KNeighborsClassifier

from sklearn import metrics
from sklearn.model_selection import train_test_split
```

## 2. Data Analysis

titanic ëŒ€íšŒì—ì„œ ì œê³µí•˜ëŠ” csv í˜•ì‹ì˜ train, test dataë¥¼ ë¶ˆëŸ¬ì˜µë‹ˆë‹¤.

`pandas` libraryë¥¼ í†µí•´ ë¶ˆëŸ¬ì˜¨ ë°ì´í„°ë“¤ì„ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.

### 2.1 Read & Check Data


```python
# pandasë¥¼ ì´ìš©í•˜ì—¬ ë°ì´í„°ë¥¼ ì½ì–´ì˜µë‹ˆë‹¤.
train = pd.read_csv('../input/titanic/train.csv')
test = pd.read_csv('../input/titanic/test.csv')
```


```python
# head() í•¨ìˆ˜ëŠ” ìƒìœ„ 5ê°œì˜ dataë¥¼ ë¶ˆëŸ¬ì˜µë‹ˆë‹¤. 
# head(10)ê³¼ ê°™ì´ ì›í•˜ëŠ” dataì˜ ê°œìˆ˜ë¥¼ inputìœ¼ë¡œ ì¤€ë‹¤ë©´, ë” ë§ì€ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

train.head(10)
```




<div markdown="0">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PassengerId</th>
      <th>Survived</th>
      <th>Pclass</th>
      <th>Name</th>
      <th>Sex</th>
      <th>Age</th>
      <th>SibSp</th>
      <th>Parch</th>
      <th>Ticket</th>
      <th>Fare</th>
      <th>Cabin</th>
      <th>Embarked</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>Braund, Mr. Owen Harris</td>
      <td>male</td>
      <td>22.0</td>
      <td>1</td>
      <td>0</td>
      <td>A/5 21171</td>
      <td>7.2500</td>
      <td>NaN</td>
      <td>S</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>Cumings, Mrs. John Bradley (Florence Briggs Th...</td>
      <td>female</td>
      <td>38.0</td>
      <td>1</td>
      <td>0</td>
      <td>PC 17599</td>
      <td>71.2833</td>
      <td>C85</td>
      <td>C</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>1</td>
      <td>3</td>
      <td>Heikkinen, Miss. Laina</td>
      <td>female</td>
      <td>26.0</td>
      <td>0</td>
      <td>0</td>
      <td>STON/O2. 3101282</td>
      <td>7.9250</td>
      <td>NaN</td>
      <td>S</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>1</td>
      <td>1</td>
      <td>Futrelle, Mrs. Jacques Heath (Lily May Peel)</td>
      <td>female</td>
      <td>35.0</td>
      <td>1</td>
      <td>0</td>
      <td>113803</td>
      <td>53.1000</td>
      <td>C123</td>
      <td>S</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>0</td>
      <td>3</td>
      <td>Allen, Mr. William Henry</td>
      <td>male</td>
      <td>35.0</td>
      <td>0</td>
      <td>0</td>
      <td>373450</td>
      <td>8.0500</td>
      <td>NaN</td>
      <td>S</td>
    </tr>
    <tr>
      <th>5</th>
      <td>6</td>
      <td>0</td>
      <td>3</td>
      <td>Moran, Mr. James</td>
      <td>male</td>
      <td>NaN</td>
      <td>0</td>
      <td>0</td>
      <td>330877</td>
      <td>8.4583</td>
      <td>NaN</td>
      <td>Q</td>
    </tr>
    <tr>
      <th>6</th>
      <td>7</td>
      <td>0</td>
      <td>1</td>
      <td>McCarthy, Mr. Timothy J</td>
      <td>male</td>
      <td>54.0</td>
      <td>0</td>
      <td>0</td>
      <td>17463</td>
      <td>51.8625</td>
      <td>E46</td>
      <td>S</td>
    </tr>
    <tr>
      <th>7</th>
      <td>8</td>
      <td>0</td>
      <td>3</td>
      <td>Palsson, Master. Gosta Leonard</td>
      <td>male</td>
      <td>2.0</td>
      <td>3</td>
      <td>1</td>
      <td>349909</td>
      <td>21.0750</td>
      <td>NaN</td>
      <td>S</td>
    </tr>
    <tr>
      <th>8</th>
      <td>9</td>
      <td>1</td>
      <td>3</td>
      <td>Johnson, Mrs. Oscar W (Elisabeth Vilhelmina Berg)</td>
      <td>female</td>
      <td>27.0</td>
      <td>0</td>
      <td>2</td>
      <td>347742</td>
      <td>11.1333</td>
      <td>NaN</td>
      <td>S</td>
    </tr>
    <tr>
      <th>9</th>
      <td>10</td>
      <td>1</td>
      <td>2</td>
      <td>Nasser, Mrs. Nicholas (Adele Achem)</td>
      <td>female</td>
      <td>14.0</td>
      <td>1</td>
      <td>0</td>
      <td>237736</td>
      <td>30.0708</td>
      <td>NaN</td>
      <td>C</td>
    </tr>
  </tbody>
</table>
</div>
</div>




```python
# columns í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ë©´, train datasetì˜ ì—´ì— í•´ë‹¹í•˜ëŠ” ì •ë³´ë“¤ì„ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

train.columns
```




{:.output_data_text}

```
Index(['PassengerId', 'Survived', 'Pclass', 'Name', 'Sex', 'Age', 'SibSp',
       'Parch', 'Ticket', 'Fare', 'Cabin', 'Embarked'],
      dtype='object')
```




```python
# dataì˜ (columns, rows)ë¥¼ ë¶ˆëŸ¬ì˜µë‹ˆë‹¤.
print("train : ", train.shape, ", test : ", test.shape)
```

{:.output_stream}

```
train :  (891, 12) , test :  (418, 11)

```


```python
# describe() í•¨ìˆ˜ëŠ” dataì˜ columns ë³„ í†µê³„ëŸ‰ì„ ê°€ì ¸ì˜µë‹ˆë‹¤.

train.describe()
```




<div markdown="0">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PassengerId</th>
      <th>Survived</th>
      <th>Pclass</th>
      <th>Age</th>
      <th>SibSp</th>
      <th>Parch</th>
      <th>Fare</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>891.000000</td>
      <td>891.000000</td>
      <td>891.000000</td>
      <td>714.000000</td>
      <td>891.000000</td>
      <td>891.000000</td>
      <td>891.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>446.000000</td>
      <td>0.383838</td>
      <td>2.308642</td>
      <td>29.699118</td>
      <td>0.523008</td>
      <td>0.381594</td>
      <td>32.204208</td>
    </tr>
    <tr>
      <th>std</th>
      <td>257.353842</td>
      <td>0.486592</td>
      <td>0.836071</td>
      <td>14.526497</td>
      <td>1.102743</td>
      <td>0.806057</td>
      <td>49.693429</td>
    </tr>
    <tr>
      <th>min</th>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>0.420000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>223.500000</td>
      <td>0.000000</td>
      <td>2.000000</td>
      <td>20.125000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>7.910400</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>446.000000</td>
      <td>0.000000</td>
      <td>3.000000</td>
      <td>28.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>14.454200</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>668.500000</td>
      <td>1.000000</td>
      <td>3.000000</td>
      <td>38.000000</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>31.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>891.000000</td>
      <td>1.000000</td>
      <td>3.000000</td>
      <td>80.000000</td>
      <td>8.000000</td>
      <td>6.000000</td>
      <td>512.329200</td>
    </tr>
  </tbody>
</table>
</div>
</div>



### 2.2 Check the Null Data


```python
# info() í•¨ìˆ˜ëŠ” ë°ì´í„°ì— ëŒ€í•œ ì „ë°˜ì ì¸ ì •ë³´ë¥¼ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.
## train dataì—ì„œëŠ” ageì™€ cabin, embarkedì— í•´ë‹¹í•˜ëŠ” ì •ë³´ë“¤ ì¤‘ NaNì´ ìˆëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

train.info()
```

{:.output_stream}

```
<class 'pandas.core.frame.DataFrame'>
RangeIndex: 891 entries, 0 to 890
Data columns (total 12 columns):
 #   Column       Non-Null Count  Dtype  
---  ------       --------------  -----  
 0   PassengerId  891 non-null    int64  
 1   Survived     891 non-null    int64  
 2   Pclass       891 non-null    int64  
 3   Name         891 non-null    object 
 4   Sex          891 non-null    object 
 5   Age          714 non-null    float64
 6   SibSp        891 non-null    int64  
 7   Parch        891 non-null    int64  
 8   Ticket       891 non-null    object 
 9   Fare         891 non-null    float64
 10  Cabin        204 non-null    object 
 11  Embarked     889 non-null    object 
dtypes: float64(2), int64(5), object(5)
memory usage: 83.7+ KB

```


```python
# info()í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šê³ , ë‹¤ìŒê³¼ ê°™ì€ ë°©bì‹ìœ¼ë¡œ NaN valueë¥¼ í™•ì¸í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.

for col in test.columns:
    print('{:<15} Percent of NaN value : train - {:.2f} %, test - {:.2f} %'.format(col, 100 * (train[col].isnull().sum() / train[col].shape[0]), 100 * (test[col].isnull().sum() / test[col].shape[0])))
```

{:.output_stream}

```
PassengerId     Percent of NaN value : train - 0.00 %, test - 0.00 %
Pclass          Percent of NaN value : train - 0.00 %, test - 0.00 %
Name            Percent of NaN value : train - 0.00 %, test - 0.00 %
Sex             Percent of NaN value : train - 0.00 %, test - 0.00 %
Age             Percent of NaN value : train - 19.87 %, test - 20.57 %
SibSp           Percent of NaN value : train - 0.00 %, test - 0.00 %
Parch           Percent of NaN value : train - 0.00 %, test - 0.00 %
Ticket          Percent of NaN value : train - 0.00 %, test - 0.00 %
Fare            Percent of NaN value : train - 0.00 %, test - 0.24 %
Cabin           Percent of NaN value : train - 77.10 %, test - 78.23 %
Embarked        Percent of NaN value : train - 0.22 %, test - 0.00 %

```

`missingno` ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•˜ë©´ nullì˜ ë¶„í¬ë¥¼ ë” ì‰½ê²Œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.


```python
msno.matrix(df=train.iloc[:, :], figsize=(8, 8), color=(0.4, 0.6, 0.8))
```




{:.output_data_text}

```
<AxesSubplot:>
```




<p align="center"><img src="https://github.com/happy-jihye/happy-jihye.github.io/blob/master/_posts/images/kaggle/kaggle-tutorial-titanic_files/kaggle-tutorial-titanic_16_1.png?raw=1" width = "500" ></p>



```python
msno.bar(df=train.iloc[:, :], figsize=(8, 8), color=(0.4, 0.6, 0.8))
```




{:.output_data_text}

```
<AxesSubplot:>
```




<p align="center"><img src="https://github.com/happy-jihye/happy-jihye.github.io/blob/master/_posts/images/kaggle/kaggle-tutorial-titanic_files/kaggle-tutorial-titanic_17_1.png?raw=1" width = "500" ></p>


### 2.3 Count the rate of Survival 

íƒ€ì´íƒ€ë‹‰ ìŠ¹ê° ì¤‘ 61.6%ì˜ ì¸ì›ë§Œì´ ì‚´ì•„ë‚¨ì•˜ìŠµë‹ˆë‹¤.


```python
f, ax = plt.subplots(1, 2, figsize=(13, 5))

train['Survived'].value_counts().plot.pie(explode=[0, 0.1], autopct='%1.1f%%', ax=ax[0], shadow=True)
ax[0].set_title('Pie plot - Survived', fontsize = 20)
ax[0].set_ylabel('')

sns.countplot('Survived', data=train, ax=ax[1])
sns.set(font_scale = 0.3)
ax[1].set_title('Count plot - Survived', fontsize = 20)

plt.show()
```


<p align="center"><img src="https://github.com/happy-jihye/happy-jihye.github.io/blob/master/_posts/images/kaggle/kaggle-tutorial-titanic_files/kaggle-tutorial-titanic_19_0.png?raw=1" width = "600" ></p>


## 3. Exploratory Data Analysis (EDA)

`Pclass`, `Name`, `Sex`, `Age`, `SibSp`, `Parch`, `Ticket`, `Fare`, `Cabin`, `Embarked` ì˜ featureë“¤ì„ ì‚´í´ë³¸ í›„, ì´ ì¤‘ ì“¸ëª¨ìˆëŠ” ë°ì´í„°ë“¤ì„ ì •ì œí•©ì‹œë‹¤.

### 3.1 Pclass

`Pclass`(ex. 1,2,3ë“±ì„)ì— ë”°ë¥¸ ìƒì¡´ë¥ ì„ í™•ì¸í•©ë‹ˆë‹¤.


```python
train[['Pclass', 'Survived']].groupby(['Pclass'], as_index = True).sum()
```




<div markdown="0">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Survived</th>
    </tr>
    <tr>
      <th>Pclass</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>136</td>
    </tr>
    <tr>
      <th>2</th>
      <td>87</td>
    </tr>
    <tr>
      <th>3</th>
      <td>119</td>
    </tr>
  </tbody>
</table>
</div>
</div>




```python
pd.crosstab(train['Pclass'], train['Survived'], margins = True)
```




<div markdown="0">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Survived</th>
      <th>0</th>
      <th>1</th>
      <th>All</th>
    </tr>
    <tr>
      <th>Pclass</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>80</td>
      <td>136</td>
      <td>216</td>
    </tr>
    <tr>
      <th>2</th>
      <td>97</td>
      <td>87</td>
      <td>184</td>
    </tr>
    <tr>
      <th>3</th>
      <td>372</td>
      <td>119</td>
      <td>491</td>
    </tr>
    <tr>
      <th>All</th>
      <td>549</td>
      <td>342</td>
      <td>891</td>
    </tr>
  </tbody>
</table>
</div>
</div>



Pclass ë³„ ìŠ¹ê°ì˜ ìˆ˜ì™€, ìƒì¡´ìì˜ ìˆ˜ë¥¼ ë‚˜íƒ€ë‚´ë©´ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.

- ì¢‹ì€ Pclassì— íƒ‘ìŠ¹í•  ìˆ˜ë¡ ìƒì¡´í•  í™•ë¥ ì´ ë†’ì€ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì„±ë³„ì— ëŒ€í•œ dataë¥¼ one-hot encoding í•´ì¤ë‹ˆë‹¤.


```python
f, ax = plt.subplots(1, 2, figsize= (13,7))

train["Pclass"].value_counts().plot.bar(ax = ax[0])
ax[0].set_title("Number of passengers By Pclass", fontsize = 13)
ax[0].set_ylabel("Count")

# using seaborn
sns.countplot("Pclass", hue = "Survived", data = train, ax = ax[1])
sns.set(font_scale = 1)
ax[1].set_title("Pclass: Survived vs Dead")
plt.show()
```


<p align="center"><img src="https://github.com/happy-jihye/happy-jihye.github.io/blob/master/_posts/images/kaggle/kaggle-tutorial-titanic_files/kaggle-tutorial-titanic_26_0.png?raw=1" width = "600" ></p>


`pclass`ì— ëŒ€í•œ dataë¥¼ `one-hot encoding` í•´ì¤ë‹ˆë‹¤.


```python
Pclass_train = pd.get_dummies(train["Pclass"])
Pclass_test = pd.get_dummies(train["Pclass"])

Pclass_train.columns = ["pclass_1", "pclass_2", "pclass_3"]
Pclass_test.columns = ["pclass_1", "pclass_2", "pclass_3"]

train.drop(["Pclass"], axis = 1, inplace = True)
test.drop(["Pclass"], axis = 1, inplace = True)

train = train.join(Pclass_train)
test = test.join(Pclass_test)
```


```python
train.head()
```




<div markdown="0">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PassengerId</th>
      <th>Survived</th>
      <th>Name</th>
      <th>Sex</th>
      <th>Age</th>
      <th>SibSp</th>
      <th>Parch</th>
      <th>Ticket</th>
      <th>Fare</th>
      <th>Cabin</th>
      <th>Embarked</th>
      <th>pclass_1</th>
      <th>pclass_2</th>
      <th>pclass_3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>0</td>
      <td>Braund, Mr. Owen Harris</td>
      <td>male</td>
      <td>22.0</td>
      <td>1</td>
      <td>0</td>
      <td>A/5 21171</td>
      <td>7.2500</td>
      <td>NaN</td>
      <td>S</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>1</td>
      <td>Cumings, Mrs. John Bradley (Florence Briggs Th...</td>
      <td>female</td>
      <td>38.0</td>
      <td>1</td>
      <td>0</td>
      <td>PC 17599</td>
      <td>71.2833</td>
      <td>C85</td>
      <td>C</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>1</td>
      <td>Heikkinen, Miss. Laina</td>
      <td>female</td>
      <td>26.0</td>
      <td>0</td>
      <td>0</td>
      <td>STON/O2. 3101282</td>
      <td>7.9250</td>
      <td>NaN</td>
      <td>S</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>1</td>
      <td>Futrelle, Mrs. Jacques Heath (Lily May Peel)</td>
      <td>female</td>
      <td>35.0</td>
      <td>1</td>
      <td>0</td>
      <td>113803</td>
      <td>53.1000</td>
      <td>C123</td>
      <td>S</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>0</td>
      <td>Allen, Mr. William Henry</td>
      <td>male</td>
      <td>35.0</td>
      <td>0</td>
      <td>0</td>
      <td>373450</td>
      <td>8.0500</td>
      <td>NaN</td>
      <td>S</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>
</div>



### 3.2 Sex

- ì—¬ì„±ì˜ ìƒì¡´ë¥ ì´ ë” ë†’ìŠµë‹ˆë‹¤.


```python
f, ax = plt.subplots(1, 2, figsize= (13,7))

train["Sex"].value_counts().plot.bar(ax = ax[0])
ax[0].set_title("Number of passengers By Sex", fontsize = 13)
ax[0].set_ylabel("Count")

# using seaborn
sns.countplot("Sex", hue = "Survived", data = train, ax = ax[1])
sns.set(font_scale = 1)
ax[1].set_title("Sex: Survived vs Dead")
plt.show()
```


<p align="center"><img src="https://github.com/happy-jihye/happy-jihye.github.io/blob/master/_posts/images/kaggle/kaggle-tutorial-titanic_files/kaggle-tutorial-titanic_31_0.png?raw=1" width = "600" ></p>


ì„±ë³„ì— ëŒ€í•œ dataë¥¼ `one-hot encoding` í•´ì¤ë‹ˆë‹¤. 


```python
sex_train = pd.get_dummies(train["Sex"])
sex_test = pd.get_dummies(train["Sex"])

sex_train.columns = ["Female", "Male"]
sex_test.columns = ["Female", "Male"]

train.drop(["Sex"], axis = 1, inplace = True)
test.drop(["Sex"], axis = 1, inplace = True)

train = train.join(sex_train)
test = test.join(sex_test)
```


```python
train.head()
```




<div markdown="0">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PassengerId</th>
      <th>Survived</th>
      <th>Name</th>
      <th>Age</th>
      <th>SibSp</th>
      <th>Parch</th>
      <th>Ticket</th>
      <th>Fare</th>
      <th>Cabin</th>
      <th>Embarked</th>
      <th>pclass_1</th>
      <th>pclass_2</th>
      <th>pclass_3</th>
      <th>Female</th>
      <th>Male</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>0</td>
      <td>Braund, Mr. Owen Harris</td>
      <td>22.0</td>
      <td>1</td>
      <td>0</td>
      <td>A/5 21171</td>
      <td>7.2500</td>
      <td>NaN</td>
      <td>S</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>1</td>
      <td>Cumings, Mrs. John Bradley (Florence Briggs Th...</td>
      <td>38.0</td>
      <td>1</td>
      <td>0</td>
      <td>PC 17599</td>
      <td>71.2833</td>
      <td>C85</td>
      <td>C</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>1</td>
      <td>Heikkinen, Miss. Laina</td>
      <td>26.0</td>
      <td>0</td>
      <td>0</td>
      <td>STON/O2. 3101282</td>
      <td>7.9250</td>
      <td>NaN</td>
      <td>S</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>1</td>
      <td>Futrelle, Mrs. Jacques Heath (Lily May Peel)</td>
      <td>35.0</td>
      <td>1</td>
      <td>0</td>
      <td>113803</td>
      <td>53.1000</td>
      <td>C123</td>
      <td>S</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>0</td>
      <td>Allen, Mr. William Henry</td>
      <td>35.0</td>
      <td>0</td>
      <td>0</td>
      <td>373450</td>
      <td>8.0500</td>
      <td>NaN</td>
      <td>S</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>
</div>



### 3.3 Age


```python
print("The Oldest Passenger : ", train["Age"].max(), " years")
print("The Youngest Passenger : ", train["Age"].min(), " years")
print("Mean of Passenger's Age : {:.2f} years".format(train["Age"].mean()))
```

{:.output_stream}

```
The Oldest Passenger :  80.0  years
The Youngest Passenger :  0.42  years
Mean of Passenger's Age : 29.70 years

```


```python
fix, ax = plt.subplots(1, 1, figsize = (8,5))

sns.kdeplot(train[train["Survived"] == 1]["Age"], ax = ax)
sns.kdeplot(train[train["Survived"] == 0]["Age"], ax = ax)

plt.legend(["Survived", "Dead"])
plt.show()
```


<p align="center"><img src="https://github.com/happy-jihye/happy-jihye.github.io/blob/master/_posts/images/kaggle/kaggle-tutorial-titanic_files/kaggle-tutorial-titanic_37_0.png?raw=1" width = "600" ></p>


ë‚˜ì´ ë²”ìœ„ì— ë”°ë¥¸ ìƒì¡´ë¥ ì„ í™•ì¸í•´ë³´ì.


```python
survival_rate = []

for i in range(int(train["Age"].min()), int(train["Age"].max())):
    survival_rate.append( train[ train["Age"] < i + 1]["Survived"].sum() / train[ train["Age"] < i + 1]["Survived"].count() )
    
plt.figure(figsize = (8, 7))
plt.plot(survival_rate)
plt.title("Survival rate change depending on range of Age")
plt.ylabel("Survival rate")
plt.xlabel("Range of Age(0-x)")
plt.show()
```


<p align="center"><img src="https://github.com/happy-jihye/happy-jihye.github.io/blob/master/_posts/images/kaggle/kaggle-tutorial-titanic_files/kaggle-tutorial-titanic_39_0.png?raw=1" width = "600" ></p>


`Age` ë°ì´í„°ëŠ” 20%ì •ë„ê°€ NaN valueì…ë‹ˆë‹¤. ì˜ ëª¨ë¥´ëŠ” ë°ì´í„°ì— ëŒ€í•´ì„œëŠ” í‰ê· ê°’ìœ¼ë¡œ ì±„ìš°ë„ë¡ í•©ì‹œë‹¤.

- randomì´ë‚˜ medium valueë¡œ ì±„ìš¸ ìˆ˜ë„ ìˆê³ , ì´ ë²”ì£¼ì— ëŒ€í•œ ë°ì´í„°ë¥¼ ì•„ì˜ˆ ë²„ë ¤ë„ ë©ë‹ˆë‹¤.


```python
print('Percent of NaN value : train - {:.2f} %, test - {:.2f} %'.format(100 * (train["Age"].isnull().sum() / train["Age"].shape[0]), 100 * (test["Age"].isnull().sum() / test["Age"].shape[0])))
```

{:.output_stream}

```
Percent of NaN value : train - 19.87 %, test - 20.57 %

```


```python
train["Age"].fillna(train["Age"].mean(), inplace = True)
test["Age"].fillna(test["Age"].mean(), inplace = True)
```

### 3.4 Family

`SibSp`(í˜•ì œ, ìë§¤)ì™€ `Parch`(ë¶€ëª¨ë‹˜)ì€ `Family`ë¼ëŠ” í•˜ë‚˜ì˜ ì¹´í…Œê³ ë¦¬ë¡œ ë¬¶ì€ í›„ ì²˜ë¦¬í•©ë‹ˆë‹¤.


```python
train["Family"] = train["SibSp"] + train["Parch"] + 1 # 1ì€ ë³¸ì¸
test["Family"] = test["SibSp"] + test["Parch"] + 1 
```


```python
train[["Name", "Family"]].head()
```




<div markdown="0">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Family</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Braund, Mr. Owen Harris</td>
      <td>2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Cumings, Mrs. John Bradley (Florence Briggs Th...</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Heikkinen, Miss. Laina</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Futrelle, Mrs. Jacques Heath (Lily May Peel)</td>
      <td>2</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Allen, Mr. William Henry</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>
</div>




```python
f, ax = plt.subplots(1, 2, figsize = (20,7))

sns.countplot("Family", hue = "Survived", data = train, ax = ax[0])
ax[0].set_title("Survived countplot dependging of FamilySize", fontsize = 16)

train[["Family", "Survived"]].groupby(["Family"], as_index = True).mean().sort_values(by = "Survived", ascending = False).plot.bar(ax = ax[1])

plt.subplots_adjust(wspace = 0.2, hspace = 0.5)
plt.show()
```


<p align="center"><img src="https://github.com/happy-jihye/happy-jihye.github.io/blob/master/_posts/images/kaggle/kaggle-tutorial-titanic_files/kaggle-tutorial-titanic_46_0.png?raw=1" width = "600" ></p>


### 3.5 Fare

íƒ‘ìŠ¹ë£Œì— ë”°ë¥¸ ìƒì¡´ë¥ ì„ í™•ì¸í•©ë‹ˆë‹¤.


```python
f, ax = plt.subplots(1, 1, figsize = (8,6))

g = sns.distplot(train["Fare"], label = "Skewness : {:.2f}".format(train["Fare"].skew()), ax = ax)
g = g.legend(loc = "best")
```


<p align="center"><img src="https://github.com/happy-jihye/happy-jihye.github.io/blob/master/_posts/images/kaggle/kaggle-tutorial-titanic_files/kaggle-tutorial-titanic_48_0.png?raw=1" width = "600" ></p>



```python
# ìœ„ì˜ Fare ê·¸ë˜í”„ë¥¼ ë³´ë©´, í™•ë¥ ë¶„í¬ê°€ ë§¤ìš° ë¹„ëŒ€ì¹­ì ì…ë‹ˆë‹¤. High Skewness
# í™•ë¥  ë¶„í¬ê°€ ë¹„ëŒ€ì¹­ì ì´ë¼ë©´, ëª¨ë¸ì´ ì˜ëª» í•™ìŠµë  ìˆ˜ë„ ìˆìœ¼ë¯€ë¡œ log í•¨ìˆ˜ë¥¼ ì·¨í•´ì¤ë‹ˆë‹¤.

train["Fare"] = train["Fare"].map(lambda i : np.log(i) if i > 0 else 0)
test["Fare"] = test["Fare"].map(lambda i : np.log(i) if i > 0 else 0)

# ë‹¤ì‹œ ê·¸ë˜í”„ ê·¸ë¦¬ê¸°

f, ax = plt.subplots(1, 1, figsize = (8,6))
g = sns.distplot(train["Fare"], label = "Skewness : {:.2f}".format(train["Fare"].skew()), ax = ax)
g = g.legend(loc = "best")
```


<p align="center"><img src="https://github.com/happy-jihye/happy-jihye.github.io/blob/master/_posts/images/kaggle/kaggle-tutorial-titanic_files/kaggle-tutorial-titanic_49_0.png?raw=1" width = "600" ></p>


íƒ‘ìŠ¹ë£Œì—ëŠ” `test` datasetì— í•˜ë‚˜ì˜ ë°ì´í„°ê°€ ë¹„ì–´ìˆìŠµë‹ˆë‹¤. ë¹ˆ ë¶€ë¶„ì— ëŒ€í•´ì„œëŠ” í‰ê· ê°’ì„ ë„£ì–´ì£¼ê² ìŠµë‹ˆë‹¤.


```python
test["Fare"].fillna(test["Fare"].mean(), inplace = True)
```

### 3.6 Cabin

`Cabin` featureëŠ” nullì˜ ë¹„ìœ¨ì´ ë§¤ìš° ë†’ìœ¼ë¯€ë¡œ ì´ë¥¼ í†µí•´ ìƒì¡´ë¥ ì„ ì˜ˆì¸¡í•˜ê¸°ê°€ ì–´ë µìŠµë‹ˆë‹¤.

ë”°ë¼ì„œ ì´ ë°ì´í„°ëŠ” ì œê±°í•˜ê³  í•™ìŠµì„ ì§„í–‰í•©ë‹ˆë‹¤.


```python
train = train.drop(["Cabin"], axis = 1)
test = test.drop(["Cabin"], axis = 1)
```

### 3.7 Embarked

íƒ‘ìŠ¹êµ¬ì— ë”°ë¥¸ ìƒì¡´ë¥ ì„ í™•ì¸í•©ë‹ˆë‹¤.


```python
f, ax = plt.subplots(1, 1, figsize = (7,7))

train[["Embarked", "Survived"]].groupby(["Embarked"], as_index = True).mean().sort_values(by = "Survived", ascending = False).plot.bar(ax = ax)
```




{:.output_data_text}

```
<AxesSubplot:xlabel='Embarked'>
```




<p align="center"><img src="https://github.com/happy-jihye/happy-jihye.github.io/blob/master/_posts/images/kaggle/kaggle-tutorial-titanic_files/kaggle-tutorial-titanic_55_1.png?raw=1" width = "600" ></p>


`Embarked`ì—ëŠ” 2ê°œì˜ Null valueê°€ ìˆì—ˆìŠµë‹ˆë‹¤. `S` íƒ‘ìŠ¹êµ¬ì— ê°€ì¥ ë§ì€ ìŠ¹ê°ì´ ìˆìœ¼ë¯€ë¡œ null valueì˜ `Embarked`ëŠ” `S`ë¡œ ì±„ì› ìŠµë‹ˆë‹¤.


```python
train["Embarked"].fillna("S", inplace = True)
test["Embarked"].fillna("S", inplace = True)
```

ë˜í•œ, í•™ìŠµì´ ìˆ˜ì›”í•˜ê²Œ ë˜ë„ë¡ one-hot encodingì„ í•´ì¤ë‹ˆë‹¤.


```python
embarked_train = pd.get_dummies(train["Embarked"])
embarked_test = pd.get_dummies(train["Embarked"])

embarked_train.columns = ["embarked_s", "embarked_c", "embarked_q"]
embarked_test.columns = ["embarked_s", "embarked_c", "embarked_q"]

train.drop(["Embarked"], axis = 1, inplace = True)
test.drop(["Embarked"], axis = 1, inplace = True)

train = train.join(embarked_train)
test = test.join(embarked_test)
```

ì´ì œ í•„ìš”í•œ ë°ì´í„°ë§Œì„ ë‚¨ê¸°ê³  ë²„ë¦¬ë„ë¡ í•©ì‹œë‹¤. ì„±ë³„ë„ femaleê³¼ male ë‘˜ ì¤‘ í•˜ë‚˜ë§Œ ë‚¨ê¹ë‹ˆë‹¤.


```python
train.head()
```




<div markdown="0">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PassengerId</th>
      <th>Survived</th>
      <th>Name</th>
      <th>Age</th>
      <th>SibSp</th>
      <th>Parch</th>
      <th>Ticket</th>
      <th>Fare</th>
      <th>pclass_1</th>
      <th>pclass_2</th>
      <th>pclass_3</th>
      <th>Female</th>
      <th>Male</th>
      <th>Family</th>
      <th>embarked_s</th>
      <th>embarked_c</th>
      <th>embarked_q</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>0</td>
      <td>Braund, Mr. Owen Harris</td>
      <td>22.0</td>
      <td>1</td>
      <td>0</td>
      <td>A/5 21171</td>
      <td>1.981001</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>1</td>
      <td>Cumings, Mrs. John Bradley (Florence Briggs Th...</td>
      <td>38.0</td>
      <td>1</td>
      <td>0</td>
      <td>PC 17599</td>
      <td>4.266662</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>2</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>1</td>
      <td>Heikkinen, Miss. Laina</td>
      <td>26.0</td>
      <td>0</td>
      <td>0</td>
      <td>STON/O2. 3101282</td>
      <td>2.070022</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>1</td>
      <td>Futrelle, Mrs. Jacques Heath (Lily May Peel)</td>
      <td>35.0</td>
      <td>1</td>
      <td>0</td>
      <td>113803</td>
      <td>3.972177</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>0</td>
      <td>Allen, Mr. William Henry</td>
      <td>35.0</td>
      <td>0</td>
      <td>0</td>
      <td>373450</td>
      <td>2.085672</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>
</div>




```python
train.drop(["PassengerId", "Name", "SibSp", "Parch", "Ticket", "Male"], axis = 1, inplace = True)
test.drop(["PassengerId", "Name", "SibSp", "Parch", "Ticket", "Male"], axis = 1, inplace = True)
```


```python
train.head()
```




<div markdown="0">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Survived</th>
      <th>Age</th>
      <th>Fare</th>
      <th>pclass_1</th>
      <th>pclass_2</th>
      <th>pclass_3</th>
      <th>Female</th>
      <th>Family</th>
      <th>embarked_s</th>
      <th>embarked_c</th>
      <th>embarked_q</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>22.0</td>
      <td>1.981001</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>38.0</td>
      <td>4.266662</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>26.0</td>
      <td>2.070022</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>35.0</td>
      <td>3.972177</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>35.0</td>
      <td>2.085672</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>
</div>



## 4. Building Machine Learning Model & Prediction using the Trained Model

Titanic problemì€ ìƒì¡´ë¥ ì„ 0ì´ë‚˜ 1ë¡œ ì˜ˆì¸¡í•˜ëŠ” binary classification ë¬¸ì œì…ë‹ˆë‹¤. ë”°ë¼ì„œ training datasetì˜ ì—¬ëŸ¬ featureë“¤ì„ ì´ìš©í•˜ì—¬ `survived` ì—¬ë¶€ë¥¼ íŒŒì•…í•˜ë„ë¡ í•©ì‹œë‹¤.

### 4.1 Preparation - Split dataset into train, valid, test set

ìš°ì„  í•™ìŠµì— ì‚¬ìš©í•  ë°ì´í„°ì—ì„œ target label(`Survived`)ë§Œì„ ë¶„ë¦¬í•©ë‹ˆë‹¤.


```python
# train dataì—ì„œ targetì— í•´ë‹¹ë˜ëŠ” ìƒì¡´ë¥ ì„ train_target ë³€ìˆ˜ì— ë¯¸ë¦¬ ì €ì¥í•©ë‹ˆë‹¤.
train_target = train["Survived"].values
train_data = train.drop("Survived", axis = 1).values
```


```python
# dataframe í˜•ì‹ìœ¼ë¡œ ë˜ì–´ìˆëŠ” testë¥¼ listë¡œ ë³€í™˜í•©ë‹ˆë‹¤.
test_value = test.values
print(test_value)
```

{:.output_stream}

```
[[34.5         2.05786033  0.         ...  0.          0.
   1.        ]
 [47.          1.94591015  1.         ...  1.          0.
   0.        ]
 [62.          2.27083639  0.         ...  0.          0.
   1.        ]
 ...
 [38.5         1.98100147  0.         ...  0.          0.
   1.        ]
 [30.27259036  2.08567209  0.         ...  0.          0.
   1.        ]
 [30.27259036  3.10719762  0.         ...  0.          0.
   1.        ]]

```

sklearnì˜ `train_test_split`í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ train datasetê³¼ valid datasetì„ ë‚˜ëˆ ì¤ë‹ˆë‹¤. 
ì´ë•Œ validì˜ ë¹„ìœ¨ì€ 30%ë¡œ ì„¤ì •í•˜ê² ìŠµë‹ˆë‹¤.


```python
data_train, data_valid, target_train, target_valid = \
        train_test_split(train_data, train_target, test_size = 0.3, random_state = 2018)
```

### 4.2 Model generation and prediction

1. Logistic Regression


```python
logistic_regression = LogisticRegression()
logistic_regression.fit(data_train, target_train)
prediction = logistic_regression.predict(data_valid)
```


```python
print("ì´ {}ëª… ì¤‘ {:.2f}%ì˜ ì •í™•ë„ë¡œ ìƒì¡´ì„ ë§ì¶¤".format(target_valid.shape[0], 100 * metrics.accuracy_score(prediction, target_valid)))
```

{:.output_stream}

```
ì´ 268ëª… ì¤‘ 84.33%ì˜ ì •í™•ë„ë¡œ ìƒì¡´ì„ ë§ì¶¤

```

2. Support Vector Machine


```python
svc = SVC()
svc.fit(data_train, target_train)
prediction = svc.predict(data_valid)
```


```python
print("ì´ {}ëª… ì¤‘ {:.2f}%ì˜ ì •í™•ë„ë¡œ ìƒì¡´ì„ ë§ì¶¤".format(target_valid.shape[0], 100 * metrics.accuracy_score(prediction, target_valid)))
```

{:.output_stream}

```
ì´ 268ëª… ì¤‘ 66.04%ì˜ ì •í™•ë„ë¡œ ìƒì¡´ì„ ë§ì¶¤

```

3. K-nearest Neighborhood


```python
knn = KNeighborsClassifier()
knn.fit(data_train, target_train)
prediction = knn.predict(data_valid)
```


```python
print("ì´ {}ëª… ì¤‘ {:.2f}%ì˜ ì •í™•ë„ë¡œ ìƒì¡´ì„ ë§ì¶¤".format(target_valid.shape[0], 100 * metrics.accuracy_score(prediction, target_valid)))
```

{:.output_stream}

```
ì´ 268ëª… ì¤‘ 76.87%ì˜ ì •í™•ë„ë¡œ ìƒì¡´ì„ ë§ì¶¤

```

4. Random Forest 


```python
random_forest = RandomForestClassifier()
random_forest.fit(data_train, target_train)
prediction = random_forest.predict(data_valid)
```


```python
print("ì´ {}ëª… ì¤‘ {:.2f}%ì˜ ì •í™•ë„ë¡œ ìƒì¡´ì„ ë§ì¶¤".format(target_valid.shape[0], 100 * metrics.accuracy_score(prediction, target_valid)))
```

{:.output_stream}

```
ì´ 268ëª… ì¤‘ 83.96%ì˜ ì •í™•ë„ë¡œ ìƒì¡´ì„ ë§ì¶¤

```

### 4.3 Feature Importance

ì–´ë–¤ featureê°€ modelì— ì˜í–¥ì„ ë§ì´ ì¤¬ëŠ”ì§€ í™•ì¸í•´ë´…ì‹œë‹¤. `random_forest` modelì—ì„œëŠ” `Age` featureê°€ modelì— ê°€ì¥ í° ì˜í–¥ì„ ì¤Œì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.


```python
from pandas import Series

feature_importance = random_forest.feature_importances_
series_feature_importance = Series(feature_importance, index = test.columns)

plt.figure(figsize = (7,7))
series_feature_importance.sort_values(ascending = True).plot.barh()
plt.xlabel("Feature Importance")
plt.ylabel("Feature")
plt.show()
```


<p align="center"><img src="https://github.com/happy-jihye/happy-jihye.github.io/blob/master/_posts/images/kaggle/kaggle-tutorial-titanic_files/kaggle-tutorial-titanic_85_0.png?raw=1" width = "600" ></p>


### 4.4 Prediction on Test set 

- ì§€ê¸ˆê¹Œì§€ì˜ ëª¨ë¸ ì¤‘ logistic regressionì´ ê°€ì¥ ì¢‹ì€ ì„±ëŠ¥ì„ ë‚´ì—ˆìŠµë‹ˆë‹¤.
- ë”°ë¼ì„œ logistic regression modelì„ ì œì¶œí•˜ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.


```python
submission = pd.read_csv("../input/titanic/gender_submission.csv")
submission.head()
```




<div markdown="0">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PassengerId</th>
      <th>Survived</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>892</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>893</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>894</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>895</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>896</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>
</div>




```python
prediction = logistic_regression.predict(test_value)
submission['Survived'] = prediction
submission.to_csv('./my_first_submission.csv', index=False)
```

---

> ğŸ˜Š ê³ ìƒí•˜ì…¨ìŠµë‹ˆë‹¤ ! ë‹¤ë¥¸ [kaggle ë”°ë¼ì¡ê¸° ì‹œë¦¬ì¦ˆ](https://happy-jihye.github.io/kaggle/)ì—ì„œ ëµ™ê² ìŠµë‹ˆë‹¤ :))

---
Reference 
- [ì´ìœ í•œë‹˜ íƒ€ì´íƒ€ë‹‰ íŠœí† ë¦¬ì–¼](https://kaggle-kr.tistory.com/18?category=868316)