---
title: "Python Web Crawling (íŒŒì´ì¬ í¬ë¡¤ë§) :: ë„¤ì´ë²„ ì›¹íˆ° ì´ë¯¸ì§€ í¬ë¡¤ë§í•˜ê¸°"
excerpt: " "

categories:
 - Notebook
tags:
 - Need_modify
layout: jupyter
search: true

# ëª©ì°¨
toc: true  
toc_sticky: true 

---

<p align="right">
  <a href="https://github.com/happy-jihye/happy-jihye.github.io/blob/master/_posts/ipynb_folder/python_crawling.ipynb" role="button" target="_blank">
    <img class="notebook-badge-image" src="/assets/badges/github.svg" alt="View On GitHub">
  </a>
  <a href="https://mybinder.org/v2/gh/happy-jihye/happy-jihye.github.io/master/_posts/ipynb_folder?filepath=python_crawling.ipynb" target="_blank">
      <img class="notebook-badge-image" src="/assets/badges/binder.svg" alt="Open In Binder"/>
  </a>
  <a href="https://colab.research.google.com/github/happy-jihye/happy-jihye.github.io/blob/master/_posts/ipynb_folder/python_crawling.ipynb" target="_blank">
      <img class="notebook-badge-image" src="/assets/badges/colab.svg" alt="Open In Colab"/>
  </a>
</p>

---

# Naver Webtoon Crawling

> â­ íŒŒì´ì¬ìœ¼ë¡œ ë„¤ì´ë²„ ì›¹íˆ° ì´ë¯¸ì§€ í¬ë¡¤ë§í•˜ê¸°
> 
> ğŸ˜ƒ ìš°ì¸¡ ìƒë‹¨ì˜ ì•„ì´ì½˜ì„ ëˆ„ë¥´ì‹œë©´ ì§ì ‘ ì‹¤ìŠµí•´ë³´ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤ :)

<p align='center'><img src='https://github.com/happy-jihye/happy-jihye.github.io/blob/master/_posts/images/python/python-crawling-4.PNG?raw=1' width = '800' ></p>

<font color='gray'><i><p align='center' style='font-size:15px'> colab ì‹¤ìŠµ í™”ë©´ </p></i></font>


## âœ” 10ê°œ íšŒì°¨ í¬ë¡¤ë§

Python Web Crawlingì— í•„ìš”í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì„¤ì¹˜í•˜ê³  Importí•œë‹¤.

- í•„ìš”í•œ Python íŒ¨í‚¤ì§€ ì„¤ì¹˜ 

    ```bash
    pip install requests bs4 pytest-shutil bboxes cvlib
    ```


```python
# Import

from bs4 import BeautifulSoup
import requests
import os
```



ì›¹íˆ° í˜ì´ì§€ì˜ html ì†ŒìŠ¤ë¥¼ ê°€ì ¸ì˜¨ í›„, `wrt_nm` classì˜ parent tagì˜ textë¥¼ webtoonName arrayì— ì €ì¥í•œë‹¤.

<p align='center'><img src='https://github.com/happy-jihye/happy-jihye.github.io/blob/master/_posts/images/python/python-crawling-1.PNG?raw=1' width = '700' ></p>

<font color='gray'><i><p align='center' style='font-size:15px'> F12ë¥¼ ëˆ„ë¥´ë©´ ê°œë°œìëª¨ë“œì— ì§„ì…í•˜ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤ğŸ˜Š </p></i></font>



```python
# Webtoon Url : ex) ë°”ë¥¸ì—°ì• ê¸¸ì¡ì´ 
url = "https://comic.naver.com/webtoon/list.nhn?titleId=703852&page=1" 

# í¬ë¡¤ë§ ìš°íšŒ
headers = {'User-Agent':'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/83.0.4103.61 Safari/537.36'}
html = requests.get(url, headers = headers)
result = BeautifulSoup(html.content, "html.parser")

webtoonName = result.find("span", {"class", "wrt_nm"}).parent.get_text().strip().split('\n')
# webtoonName = ['ë°”ë¥¸ì—°ì•  ê¸¸ì¡ì´', '\t\t\t\t\t\t\të‚¨ìˆ˜']
```

í˜„ì¬ directoryì˜ í•˜ìœ„ í´ë”ì— ì´ë¯¸ì§€ë¥¼ ì €ì¥í•  folderë¥¼ ë§Œë“ ë‹¤.


```python
cwd = os.getcwd()
files = os.listdir(cwd)
# í˜„ì¬ directory ìœ„ì¹˜
print(cwd, end='\n\n')

# í¬ë¡¤ë§í•œ ì´ë¯¸ì§€ë¥¼ ì €ì¥í•  í´ë”ë¥¼ ë§Œë“¦
if os.path.isdir(os.path.join(cwd,  webtoonName[0])) == False: 
    os.mkdir(webtoonName[0])
   
print(webtoonName[0] + " folder created successfully!")
os.chdir(os.path.join(cwd,  webtoonName[0])) 
```

{:.output_stream}

```
/home/jihye/Home/blog/_posts/ipynb_folder

ë°”ë¥¸ì—°ì•  ê¸¸ì¡ì´ folder created successfully!

```

`title` classì˜ `td` tag ì°¾ì€ í›„, ìµœê·¼ 10íšŒì°¨ì— ëŒ€í•œ ì›¹íˆ° ì´ë¯¸ì§€ë¥¼ í¬ë¡¤ë§í•œë‹¤.


```python
title = result.findAll("td", {"class", "title"})

for t in title:
    
    # íšŒì°¨ë³„ë¡œ directoryë¥¼ ë§Œë“  í›„ í•´ë‹¹ directoryë¡œ ì´ë™
    os.mkdir((t.text).strip()) 
    os.chdir(os.getcwd() + "//" + (t.text).strip()) 

    # ê° íšŒì°¨ë³„ html ì†ŒìŠ¤ ê°€ì ¸ì˜¤ê¸°
    url ="https://comic.naver.com" + t.a['href']
    html2 = requests.get(url, headers = headers) 
    result2 = BeautifulSoup(html2.content, "html.parser") 

    # webtoon image ê°€ì ¸ì˜¤ê¸°
    webtoonImg = result2.find("div", {"class", "wt_viewer"}).findAll("img")
    num = 1 #image_name
    
    for i in webtoonImg:
        saveName = os.getcwd() + "//" + str(num) + ".jpg"
        with open(saveName, "wb") as file:
            src = requests.get(i['src'], headers = headers) 
            file.write(src.content) #
        num += 1

    os.chdir("..")

    # í•œ íšŒì°¨ ì´ë¯¸ì§€ ì €ì¥ ì™„ë£Œ!
    print((t.text).strip() + "   saved completely!") 
```

{:.output_stream}

```
149   saved completely!
148   saved completely!
147   saved completely!
146   saved completely!
145   saved completely!
144   saved completely!
143   saved completely!
142   saved completely!
141   saved completely!
140   saved completely!

```

- í¬ë¡¤ë§ ê²°ê³¼

<p align='center'><img src='https://github.com/happy-jihye/happy-jihye.github.io/blob/master/_posts/images/python/python-crawling-3.PNG?raw=1' width = '800' ></p>



## âœ” ì „ì²´ íšŒì°¨ í¬ë¡¤ë§

> ìœ„ì˜ ì£¼í”¼í„° ë…¸íŠ¸ë¶ì„ í™œìš©í•˜ë©´ 10ê°œì˜ íšŒì°¨ì— ëŒ€í•´ í¬ë¡¤ë§í•  ìˆ˜ ìˆë‹¤. ì´ë²ˆì—ëŠ” ì›¹íˆ°ì˜ ë” ë§ì€ íšŒì°¨ì— ëŒ€í•´ í¬ë¡¤ë§ í•´ë³¸ë‹¤.


``` python
from bs4 import BeautifulSoup
import requests
import os

# í¬ë¡¤ë§í•˜ê³  ì‹¶ì€ í˜ì´ì§€ì˜ ê°œìˆ˜
page_num = 18

for i in range(page_num):

    # Webtoon Url : ex) ë°”ë¥¸ì—°ì• ê¸¸ì¡ì´ 
    url = "https://comic.naver.com/webtoon/list.nhn?titleId=703846&page={0}".format(i) 

    # í¬ë¡¤ë§ ìš°íšŒ
    headers = {'User-Agent':'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/83.0.4103.61 Safari/537.36'}
    html = requests.get(url, headers = headers)
    result = BeautifulSoup(html.content, "html.parser")

    webtoonName = result.find("span", {"class", "wrt_nm"}).parent.get_text().strip().split('\n')

    cwd = os.getcwd()
    files = os.listdir(cwd)
    print(cwd)

    if os.path.isdir(os.path.join(cwd,  webtoonName[0])) == False: 
        os.mkdir(webtoonName[0])
    

    print(webtoonName[0] + "page {0} folder created successfully!".format(i))
    os.chdir(os.path.join(cwd,  webtoonName[0])) 
    
    title = result.findAll("td", {"class", "title"})

    for t in title:
        
        #ì›¹íˆ° ë””ë ‰í† ë¦¬ ì•ˆì— íšŒì°¨ë³„ë¡œ ë””ë ‰í† ë¦¬ ë§Œë“¤ê¸°
        if os.path.isdir(os.path.join(cwd,  webtoonName[0], (t.text).strip())): 
            break
        
        os.mkdir((t.text).strip()) 

        #íšŒì°¨ë³„ ë””ë ‰í† ë¦¬ë¡œ ì´ë™
        os.chdir(os.getcwd() + "//" + (t.text).strip()) 
        print(os.getcwd())
        #ê° íšŒì°¨ë³„ url
        url ="https://comic.naver.com" + t.a['href']
        #í—¤ë” ìš°íšŒí•´ì„œ ë§í¬ ê°€ì ¸ì˜¤ê¸°
        html2 = requests.get(url, headers = headers) 
        result2 = BeautifulSoup(html2.content, "html.parser") 

        # webtoon image ì°¾ê¸°
        webtoonImg = result2.find("div", {"class", "wt_viewer"}).findAll("img")
        num = 1 #image_name
        
        for i in webtoonImg:
            saveName = os.getcwd() + "//" + str(num) + ".jpg"
            with open(saveName, "wb") as file:
                src = requests.get(i['src'], headers = headers) 
                file.write(src.content) #
            num += 1

        os.chdir("..")

        # í•œ íšŒì°¨ ì´ë¯¸ì§€ ì €ì¥ ì™„ë£Œ!
        print((t.text).strip() + "   saved completely!") 
        
    os.chdir("..")

```

<p align='center'><img src='https://github.com/happy-jihye/happy-jihye.github.io/blob/master/_posts/images/python/python-crawling-2.PNG?raw=1' width = '800' ></p>

í¬ë¡¤ë§ ì„±ê³µ !!

- reference
  
    [https://github.com/wngus4296/20_1_pythonStudy](https://github.com/wngus4296/20_1_pythonStudy)

